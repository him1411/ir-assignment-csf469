In Microsoft SQL Server how can I get a query execution plan for a query / stored procedure?There are a number of methods of obtaining an execution plan, which one to use will depend on your circumstances.  Usually you can use SQL Server Management Studio to get a plan, however if for some reason you can\'t run your query in SQL Server Management Studio then you might find it helpful to be able to obtain a plan via SQL Server Profiler or by inspecting the plan cache.SQL Server comes with a couple of neat features that make it very easy to capture an execution plan, simply make sure that the "Include Actual Execution Plan" menu item (found under the "Query" menu) is ticked and run your query as normal.If you are trying to obtain the execution plan for statements in a stored procedure then you should execute the stored procedure, like so:When your query completes you should see an extra tab entitled "Execution plan" appear in the results pane.  If you ran many statements then you may see many plans displayed in this tab.From here you can inspect the execution plan in SQL Server Management Studio, or right click on the plan and select "Save Execution Plan As ..." to save the plan to a file in XML format.This method is very similar to method 1 (in fact this is what SQL Server Management Studio does internally), however I have included it for completeness or if you don\'t have SQL Server Management Studio available.Before you run your query, run one of the following statements.  The statement must be the only statement in the batch, i.e. you cannot execute another statement at the same time:These are connection options and so you only need to run this once per connection. From this point on all statements run will be acompanied by an additional resultset containing your execution plan in the desired format - simply run your query as you normally would to see the plan.Once you are done you can turn this option off with the following statement:Unless you have a strong preference my recommendation is to use the STATISTICS XML option. This option is equivalent to the "Include Actual Execution Plan" option in SQL Server Management Studio and supplies the most information in the most convenient format.If you can\'t run your query directly (or your query doesn\'t run slowly when you execute it directly - remember we want a plan of the query performing badly), then you can capture a plan using a SQL Server Profiler trace.  The idea is to run your query while a trace that is capturing one of the "Showplan" events is running.Note that depending on load you can use this method on a production environment, however you should obviously use caution.  The SQL Server profiling mechanisms are designed to minimize impact on the database but this doesn\'t mean that there won\'t be any performance impact.  You may also have problems filtering and identifying the correct plan in your trace if your database is under heavy use.  You should obviously check with your DBA to see if they are happy with you doing this on their precious database!The plan you get is equivalent to the "Include Actual Execution Plan" option in SQL Server Management Studio.If you can\'t run your query directly and you also can\'t capture a profiler trace then you can still obtain an estimated plan by inspecting the SQL query plan cache.We inspect the plan cache by querying SQL Server DMVs.  The following is a basic query which will list all cached query plans (as xml) along with their SQL text.  On most database you will also need to add additional filtering clauses to filter the results down to just the plans you are interested in.Execute this query and click on the  plan XML to open up the plan in a new window - right click and select "Save execution plan as..." to save the plan to file in XML format.Because there are so many factors involved (ranging from the table and index schema down to the data stored and the table statistics) you should always try to obtain an execution plan from the database you are interested in (normally the one that is experiencing a performance problem).You can\'t capture an execution plan for encrypted stored procedures.An actual execution plan is one where SQL Server actually runs the query, whereas an estimated execution plan SQL Server works out what it would do without executing the query.  Although logically equivalent, an actual execution plan is much more useful as it contains additional details and statistics about what actually happened when executing the query.  This is essential when diagnosing problems where SQL Servers estimations are off (such as when statistics are out of date).This is a topic worthy enough for a (free) book in its own right.In addition to the comprehensive answer already posted sometimes it is useful to be able to access the execution plan programatically to extract information. Example code for this is below. Assuming you\'re using Microsoft SQL Server Management StudioMy favourite tool for obtaining and deeply analyzing query execution plans is SQL Sentry Plan Explorer. It\'s much more user-friendly, convenient and comprehensive for the detail analysis and visualization of execution plans than SSMS.Here is a sample screen shot for you to have an idea of what functionality is offered by the tool:It\'s only one of the views available in the tool. Notice a set of tabs to the bottom of the app window, which lets you get different types of your execution plan representation and useful additional information as well.In addition, I haven\'t noticed any limitations of its free edition that prevents using it on a daily basis or forces you to purchase the Pro version eventually. So, if you prefer to stick with the free edition, nothing forbids you from doing so.UPDATE: (Thanks to Martin Smith) Plan Explorer now is free! See http://www.sqlsentry.com/products/plan-explorer/sql-server-query-view for details.Query plans can be obtained from an Extended Events session via the query_post_execution_showplan event.  Here\'s a sample XEvent session:After you create the session, (in SSMS) go to the Object Explorer and delve down into Management | Extended Events | Sessions.  Right-click the "GetExecutionPlan" session and start it.  Right-click it again and select "Watch Live Data".  Next, open a new query window and run one or more queries.  Here\'s one for AdventureWorks:After a moment or two, you should see some results in the "GetExecutionPlan: Live Data" tab.  Click one of the query_post_execution_showplan events in the grid, and then click the "Query Plan" tab below the grid.  It should look similar to this:EDIT: The XEvent code and the screen shot were generated from SQL/SSMS 2012 w/ SP2.  If you\'re using SQL 2008/R2, you might be able to tweak the script to make it run.  But that version doesn\'t have a GUI, so you\'d have to extract the showplan XML, save it as a *.sqlplan file and open it in SSMS.  That\'s cumbersome.  XEvents didn\'t exist in SQL 2005 or earlier.  So, if you\'re not on SQL 2012 or later, I\'d strongly suggest one of the other answers posted here.Beside the methods described in previous answers, you can also use a free execution plan viewer and query optimization tool ApexSQL Plan (which I\xe2\x80\x99ve recently bumped into).You can install and integrate ApexSQL Plan into SQL Server Management Studio, so execution plans can be viewed from SSMS directly.Viewing Estimated execution plans in ApexSQL PlanViewing Actual execution plans in ApexSQL PlanTo view the Actual execution plan of a query, continue from the 2nd step mentioned previously, but now, once the Estimated plan is shown, click the \xe2\x80\x9cActual\xe2\x80\x9d button from the main ribbon bar in ApexSQL Plan.Once the \xe2\x80\x9cActual\xe2\x80\x9d button is clicked, the Actual execution plan will be shown with detailed preview of the cost parameters along with other execution plan data.More information about viewing execution plans can be found by following this link.