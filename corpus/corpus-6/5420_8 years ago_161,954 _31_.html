I am processing a TreeView of directories and files. A user can select either a file or a directory and then do something with it. This requires me to have a method which performs different actions based on the user\'s selection.At the moment I am doing something like this to determine whether the path is a file or a directory:I cannot help to feel that there is a better way to do this! I was hoping to find a standard .NET method to handle this, but I haven\'t been able to do so. Does such a method exist, and if not, what is the most straightforward means to determine whether a path is a file or directory?From How to tell if path is file or directory: Per the comments below, if you are on .NET 4.0 or later (and maximum performance is not critical) you can write the code in a cleaner way:How about using these?With only this line you can get if a path is a directory or a file:The most accurate approach is going to be using some interop code from the shlwapi.dllYou would then call it like this:As an alternative to Directory.Exists(), you can use the File.GetAttributes() method to get the attributes of a file or a directory, so you could create a helper method like this:You could also consider adding an object to the tag property of the TreeView control when populating the control that contains additional metadata for the item.  For instance, you could add a FileInfo object for files and a DirectoryInfo object for directories and then test for the item type in the tag property to save making additional system calls to get that data when clicking on the item.This was the best I could come up with given the behavior of the Exists and Attributes properties:Here\'s how it tests out:Here\'s mine:It\'s similar to others\' answers but not exactly the same.I came across this when facing a similar problem, except I needed to check if a path is for a file or folder when that file or folder may not actually exist. There were a few comments on answers above that mentioned they would not work for this scenario. I found a solution (I use VB.NET, but you can convert if you need) that seems to work well for me:Hopefully this can be helpful to someone!soooo late in the game i know, but thought i\'d share this anyway. If you are solely working with the paths as strings, figuring this out is easy as pie:for example:\nThePath == "C:\\SomeFolder\\File1.txt" would end up being this:Another example:\nThePath == "C:\\SomeFolder\\" would end up being this:And this would also work without the trailing backslash:\nThePath == "C:\\SomeFolder" would end up being this:Keep in mind here that this only works with the paths themselves, and not the relationship between the path and the "physical disk"... so it can\'t tell you if the path/file exists or anything like that, but it sure can tell you if the path is a folder or a file...Here\'s what we use:I use the following, it also tests the extension which means it can be used for testing if the path supplied is a file but a file that doesn\'t exist.If you want to find directories, including those that are marked "hidden" and "system", try this (requires .NET V4): I needed this, the posts helped, this gets it down to one line, and if the path isn\'t a path at all, it just returns and exits the method.  It addresses all of the above concerns, doesn\'t need the trailing slash either.Using the selected answer on this post, I looked at the comments and give credence to \n@\xc5\x9eafakG\xc3\xbcr, @Anthony and @Quinn Wilson for their info bits that lead me to this improved answer which I wrote and tested:After combining the suggestions from the other answers, I realized I came up with about the same thing as Ronnie Overby\'s answer.  Here are some tests to point out some things to think about:Wouldn\'t this work?This is using DirectoryInfo to get the attributeThis will work if you trying to get through DirectoryInfo trying to create a TreeView or read a TreeView