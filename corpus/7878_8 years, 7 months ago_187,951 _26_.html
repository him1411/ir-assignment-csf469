This question already has an answer here:I\'d like to write a test script or program that asserts that all DLL files in a given directory are of a particular build type.I would use this as a sanity check at the end of a build process on an SDK to make sure that the 64-bit version hasn\'t somehow got some 32-bit DLL files in it and vice versa.Is there an easy way to look at a DLL file and determine its type?The solution should work on both xp32 and xp64.A DLL uses the PE executable format, and it\'s not too tricky to read that information out of the file.See this MSDN article on the PE File Format for an overview. You need to read the MS-DOS header, then read the IMAGE_NT_HEADERS structure. This contains the IMAGE_FILE_HEADER structure which contains the info you need in the Machine member which contains one of the following valuesThis information should be at a fixed offset in the file, but I\'d still recommend traversing the file and checking the signature of the MS-DOS header and the IMAGE_NT_HEADERS to be sure you cope with any future changes. You can also use the ImageHelp API to do this - load the DLL with LoadImage and you\'ll get a LOADED_IMAGE structure which will contain a pointer to an IMAGE_NT_HEADERS structure. Deallocate the LOADED_IMAGE with ImageUnload.Here\'s rough Perl script which gets the job done. It checks the file has a DOS header, then reads the PE offset from the IMAGE_DOS_HEADER 60 bytes into the file.It then seeks to the start of the PE part, reads the signature and checks it, and then extracts the value we\'re interested in.A crude way would be to call dumpbin with the headers option from the Visual Studio tools on each DLL and look for the appropriate output:You can see a couple clues in that output that it is a 32 bit DLL, including the 14C value that Paul mentions.  Should be easy to look for in a script.If you have Cygwin installed (which I strongly recommend for a variety of reasons), you could use the \'file\' utility on the DLLwhich would give an output like this:Dependency Walker tells all(well almost). \nhttp://www.dependencywalker.com/It does not "install" -just get it, extract it and run the exec.\nIt works for any x32 or x64 windows module|application.As I recall it is fairly straightforward to see all dependencies, i.e. the  dll modules, and since the appl. is a sum of the dependencies one can ascertain if it is full x64, x32(x86) or a bit of each. Type of CPU that the module was built for is in the "CPU" column.  Most 64-bit aps are still a bit of each but 32-bit ap w/b all x86. Beautiful program for geeks/programmers and it is free...I have written a very simple tool that does exactly that - it\'s called PE Deconstructor.Simply fire it up and load your DLL file:In the example above, the loaded DLL is 32-bit.You can download it here (I only have the 64-bit version compiled ATM):\nhttp://files.quickmediasolutions.com/exe/pedeconstructor_0.1_amd64.exeAn older 32-bit version is available here:\nhttp://dl.dropbox.com/u/31080052/pedeconstructor.zip