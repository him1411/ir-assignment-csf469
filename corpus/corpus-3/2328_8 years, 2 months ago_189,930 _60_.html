I have JavaScript that is doing activity periodically. When the user is not looking at the site (i.e., the window or tab does not have focus), it\'d be nice to not run.Is there a way to do this using JavaScript?My reference point: Gmail Chat plays a sound if the window you\'re using isn\'t active. Since originally writing this answer, a new specification has reached recommendation status thanks to the W3C.\xe2\x80\x82The Page Visibility API (on MDN) now allows us to more accurately detect when a page is hidden to the user.Current browser support:The following code makes use of the API, falling back to the less reliable blur/focus method in incompatible browsers.onfocusin and onfocusout are required for IE 9 and lower, while all others make use of onfocus and onblur, except for iOS, which uses onpageshow and onpagehide.I would use jQuery because then all you have to do is this:Or at least it worked for me.There are 3 typical methods used to determine if the user can see the HTML page, however none of them work perfectly:The W3C Page Visibility API is supposed to do this (supported since: Firefox 10, MSIE 10, Chrome 13). However, this API only raises events when the browser tab is fully overriden (e.g. when the user changes from one tab to another one). The API does not raise events when the visibility cannot be determined with 100% accuracy (e.g. Alt+Tab to switch to another application).Using focus/blur based methods gives you a lot of false positive. For example, if the user displays a smaller window on top of the browser window, the browser window will loose the focus (onblur raised) but the user is still able to see it (so it still need to be refreshed). See also http://javascript.info/tutorial/focusIn order to improve the imperfect behaviors described above, I use a combination of the 3 methods: W3C Visibility API, then focus/blur and user activity methods in order to reduce the false positive rate. This allows to manage the following events:This is how it works: when the document loose the focus, the user activity (such as mouse move) on the document is monitored in order to determine if the window is visible or not. The page visibility probability is inversely proportional to the time of the last user activity on the page: if the user makes no activity on the document for a long time, the page is most probably not visible. The code below mimics the W3C Page Visibility API: it behaves the same way but has a small false positive rate. It has the advantage to be multibrowser (tested on Firefox 5, Firefox 10, MSIE 9, MSIE 7, Safari 5, Chrome 9).Since there is currently no working cross-browser solution without false positive, you should better think twice about disabling periodical activity on your web site.There is a neat library available on GitHub:https://github.com/serkanyersen/ifvisible.jsExample:I\'ve tested version 1.0.1 on all browsers I have and can confirm that it works with:... and probably all newer versions.Doesn\'t fully work with:This is really tricky. There seems to be no solution given the following requirements.This happens because:Given these restrictions, it is possible to implement a solution that combines \n- The page Visibility API\n- window blur/focus\n- document.activeElementThat is able to:When the iframe has focus, your blur/focus events don\'t get invoked at all, and the page Visibility API won\'t trigger on alt+tab.I built upon @AndyE\'s solution and implemented this (almost good) solution here:\nhttps://dl.dropboxusercontent.com/u/2683925/estante-components/visibility_test1.html\n(sorry, I had some trouble with JSFiddle).This is also available on Github: https://github.com/qmagico/estante-componentsThis works on chrome/chromium.\nIt kind works on firefox, except that it doesn\'t load the iframe contents (any idea why?)Anyway, to resolve the last problem (4), the only way you can do that is to listen for blur/focus events on the iframe.\nIf you have some control over the iframes, you can use the postMessage API to do that.https://dl.dropboxusercontent.com/u/2683925/estante-components/visibility_test2.htmlI still haven\'t tested this with enough browsers.\nIf you can find more info about where this doesn\'t work, please let me know in the comments below.I create a Comet Chat for my app, and when i receive a message from another user i usehttp://jsfiddle.net/ARTsinn/JTxQY/u can use :I started off using the community wiki answer, but realised that it wasn\'t detecting alt-tab events in Chrome. This is because it uses the first available event source, and in this case it\'s the page visibility API, which in Chrome seems to not track alt-tabbing.I decided to modify the script a bit to keep track of all possible events for page focus changes. Here\'s a function you can drop in:Use it like this:A slightly more complicated way would be to use setInterval() to check mouse position and compare to last check. If the mouse hasn\'t moved in a set amount of time, the user is probably idle.This has the added advantage of telling if the user is idle, instead of just checking if the window is not active.As many people have pointed out, this is not always a good way to check whether the user or browser window is idle, as the user might not even be using the mouse or is watching a video, or similar. I am just suggesting one possible way to check for idle-ness.This is an adaptation of the answer from Andy E.This will do a task e.g. refresh the page every 30 seconds,\nbut only if the page is visible and focused.If visibility can\'t be detected, then only focus will be used.If the user focuses the page, then it will update immediatelyThe page won\'t update again until 30 seconds after any ajax callUsing : Page Visibility APICan i use ? http://caniuse.com/#feat=pagevisibilityIn HTML 5 you could also use:See:For angular.js, here is a directive (based on the accepted answer) that will allow your controller to react to a change in visibility:You can use it like this example: <div react-on-window-focus="refresh()">, where refresh() is a scope function in the scope of whatever Controller is in scope.For a solution without jQuery check out Visibility.js which provides information about three page statesand also convenience-wrappers for setIntervalA fallback for older browsers (IE < 10; iOS < 7) is also availableIf you want to act on whole browser blur:\nAs I commented, if browser loose focus none of the suggested events fire. My idea is to count up in a loop and reset the counter if an event fire. If the counter reach a limit I do a location.href to an other page. This also fire if you work on dev-tools. This is a draft successful tested on FF.Just wanted to add:\nThe question is not clear written.\n"When the user is not looking at the site (i.e., the window or tab does not have focus)..."I can look at a site when it is not having focus. Most desktop systems are able to show windows in parallel :)That\'s why Page visibility API is probably the right answer because it prevents updating the site when the "user is not able to see updates" which can be very different to "tab does not have focus".