Facebook callback has started appending #_=_ hash underscore to the Return URLDoes anyone know why? What is the solution?via Facebook\'s Platform Updates:Change in Session Redirect BehaviorThis week, we started adding a fragment #____=____ to the redirect_uri when\n  this field is left blank. Please ensure that your app can handle this\n  behavior.To prevent this, set the redirect_uri in your login url request like so: (using Facebook php-sdk)UPDATEThe above is exactly as the documentation says to fix this.  However, Facebook\'s documented solution does not work.  Please consider leaving a comment on the Facebook Platform Updates blog post and follow this bug to get a better answer.  Until then, add the following to your head tag to resolve this issue:Or a more detailed alternative (thanks niftylettuce):TL;DRFull version with step by step instructionsStep by step:Learn more about history.replaceState.Learn more about window.location.if you want to remove the remaining "#" from the urlNot sure why they\'re doing this but, you could get around this by reseting the hash at the top of your page:This was implemented by Facebook by design for security reasons. Here\'s the explanation from Eric Osgood, a Facebook Team member:This has been marked as \'by design\'\n  because it prevents a potential security vulnerability.Some browsers will append the hash fragment from a URL to the end of a\n  new URL to which they have been redirected (if that new URL does not\n  itself have a hash fragment).For example if example1.com returns a redirect to example2.com, then a\n  browser going to example1.com#abc will go to example2.com#abc, and the\n  hash fragment content from example1.com would be accessible to a\n  script on example2.com.Since it is possible to have one auth flow redirect to another, it\n  would be possible to have sensitive auth data from one app accessible\n  to another.This is mitigated by appending a new hash fragment to the redirect URL\n  to prevent this browser behavior.If the aesthetics, or client-side behavior, of the resulting URL are\n  of concern, it would be possible to use window.location.hash (or even\n  a server-side redirect of your own) to remove the offending\n  characters.Source: https://developers.facebook.com/bugs/318390728250352/Facebook uses a frame and inside of it everything functions using AJAX communication. The biggest problem in this case is preserving the current page state.  As far I understand, Facebook decided to use simulated anchors.  This means if you clicked somewhere, they simulate that as an anchor inside of your page, and when the AJAX communication starts, they change the anchor bit of your URL as well.This solution helps you normally when you try to reload the page (not ENTER, press F5), because your browser sends the whole URL with anchors to the Facebook server.  Therefore Facebook picks up the latest state (what you see) and you are then able to continue from there.When the callback returns with #_=_ it means that the page was in its basic state prior to leaving it.  Because this anchor is parsed by the browser, you need not worry about it.Major annoying, especially for apps that parse the URI and not just read the $_GET... Here\'s the hack I threw together... Enjoy!You can also specify your own hash on the redirect_uri parameter for the Facebook callback, which might be helpful in certain circumstances e.g. /api/account/callback#home. When you are redirected back, it\'ll at least be a hash that corresponds to a known route if you are using backbone.js or similar (not sure about jquery mobile).This can become kind of a serious issue if you\'re using a JS framework with hashbang (/#!/) URLs, e.g. Angular. Indeed, Angular will consider URLs with a non-hashbang fragment as invalid and throw an error :If you\'re in such a case (and redirecting to your domain root), instead of doing :Simply do :I do not see how this problem is related to facebook AJAX. In fact the issue also occurs with JavaScript disabled and purely redirect based logins.  An example exchange with facebook:  Happens only with Firefox for me too.Adding this to my redirect page fixed the problem for me ...With angular and angular ui router, you can fix this A change was introduced recently in how Facebook handles session redirects. See "Change in Session Redirect Behavior" in this week\'s Operation Developer Love blog post for the announcement.A workaround that worked for me (using Backbone.js), was to add "#/" to the end of the redirect URL passed to Facebook. Facebook will keep the provided fragment, and not append its own "_=_".Upon return, Backbone will remove the "#/" part. For AngularJS, appending "#!" to the return URL should work.Note that the fragment identifier of the original URL is preserved on redirection (via HTTP status codes 300, 301, 302 and 303) by most browsers, unless the redirect URL also has a fragment identifier. This seems to be recommended behaviour.If you use a handler script that redirects the user elsewhere, you can append "#" to the redirect URL here to replace the fragment identifier with an empty string.For me, i make JavaScript redirection to another page to get rid of #_=_. The ideas below should work. :)Using Angular 2 (RC5) and hash-based routes, I do this:andAs far as I understand, the = character in the route is interpreted as part of optional route parameters definition (see https://angular.io/docs/ts/latest/guide/router.html#!#optional-route-parameters), so not involved in the route matching.I know this reply is late, but if you are using passportjs, you might want to see this. I have written this middleware and applied it to express server instance, and the original URL I\'ve got is without the "#_=_". Looks like it when we apply passporJS\' instance as middleware to the server instance, it doesn\'t take those characters, but are only visible on the address bar of our browsers. 