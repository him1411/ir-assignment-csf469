Possible Duplicate:\n  PHP 2-way encryption: I need to store passwords that can be retrieved I plan to store foreign account information for my users on my website, aka rapidshare username and passwords, etc... I want to keep information secure, but I know that if I hash their information, I can\'t retrieve it for later use. Base64 is decrypt-able so there\'s no point using that just plain off.\nMy idea is to scramble the user and pass before and after it gets base64ed that way even after you decrypt it, you get some funny looking text if you try to decrypt. Is there a php function that accepts values that will make an unique scramble of a string and de-scramble it later when the value is reinputed?Any suggestions?You should not encrypt passwords, instead you should hash them using an algorithm like bcrypt. This answer explains how to properly implement password hashing in PHP. Still, here is how you would encrypt/decrypt:To Encrypt:To Decrypt:Warning: The above example encrypts information, but it does not authenticate the ciphertext to prevent tampering. You should not rely on unauthenticated encryption for security, especially since the code as provided is vulnerable to padding oracle attacks.See also:Also, don\'t just use a "password" for an encryption key. Encryption keys are random strings.Demo at 3v4l.org:Security Warning: This class is not secure. It\'s using Rijndael256-ECB, which is not semantically secure. Just because "it works" doesn\'t mean "it\'s secure". Also, it strips tailing spaces afterwards due to not using proper padding.Found this class recently, it works like a dream!And to call it:Security warning: This code is not secure.working exampleOne thing you should be very aware of when dealing with encryption:Trying to be clever and inventing your own thing usually will leave you with something insecure. You\'d probably be best off using one of the cryptography extensions that come with PHP.This will only give you marginal protection. If the attacker can run arbitrary code in your application they can get at the passwords in exactly the same way your application can. You could still get some protection from some SQL injection attacks and misplaced db backups if you store a secret key in a file and use that to encrypt on the way to the db and decrypt on the way out. But you should use bindparams to completely avoid the issue of SQL injection.If decide to encrypt, you should use some high level crypto library for this, or you will get it wrong. You\'ll have to get the key-setup, message padding and integrity checks correct, or all your encryption effort is of little use. GPGME is a good choice for one example. Mcrypt is too low level and you will probably get it wrong.Securiy Warning: This code is insecure. In addition to being vulnerable to chosen-ciphertext attacks, its reliance on unserialize() makes it vulnerable to PHP Object Injection.To handle a string / array I use these two functions:It\'s flexible as in you can store/send via URL a string or array because the string/array is serialzed before encryption.Check out mycrypt(): http://us.php.net/manual/en/book.mcrypt.phpAnd if you\'re using postgres there\'s pgcrypto for database level encryption. (makes it easier to search and sort) The best idea to encrypt/decrypt your data in the database even if you have access to the code is to use 2 different passes a private password (user-pass) for each user and a private code for all users (system-pass).Scenario