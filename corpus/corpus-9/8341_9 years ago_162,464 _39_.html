I am looking for a simple way to get a mime type where the file extension is incorrect or not given, something similar to this question only in .Net.In Urlmon.dll, there\'s a function called FindMimeFromData.From the documentation MIME type detection, or "data sniffing," refers to the process of determining an appropriate MIME type from binary data. The final result depends on a combination of server-supplied MIME type headers, file extension, and/or the data itself. Usually, only the first 256 bytes of data are significant. So, read the first (up to) 256 bytes from the file and pass it to FindMimeFromData.I did use urlmon.dll in the end. I thought there would be an easier way but this works. I include the code to help anyone else and allow me to find it again if I need it....I\'ve found a hard-coded solution, I hope i will help somebody:Edit: Just use Mime DetectiveI use byte array sequences to determine the correct MIME type of a given file. The advantage of this over just looking at the file extension of the file name is that if a user were to rename a file to bypass certain file type upload restrictions, the file name extension would fail to catch this. On the other hand, getting the file signature via byte array will stop this mischievous behavior from happening.Here is an example in C#:Notice I handled DOCX file types differently since DOCX is really just a ZIP file. In this scenario, I simply check the file extension once I verified that it has that sequence. This example is far from complete for some people, but you can easily add your own.If you want to add more MIME types, you can get the byte array sequences of many different file types from here. Also, here is another good resource concerning file signatures. What I do a lot of times if all else fails is step through several files of a particular type that I am looking for and look for a pattern in the byte sequence of the files. In the end, this is still basic verification and cannot be used for 100% proof of determining file types.If you\'re using .NET Framework 4.5 or above, there is a now a MimeMapping.GetMimeMapping(filename) method that will return a string with the correct Mime mapping for the passed filename. Note those does not use the data in the file itself.Documentation is at http://msdn.microsoft.com/en-us/library/system.web.mimemapping.getmimemappingYou can also look in the registry.One way or another you\'re going to have to tap into a database of MIMEs - whether they\'re mapped from extensions or magic numbers is somewhat trivial - windows registry is one such place.\nFor a platform independent solution though one would have to ship this DB with the code (or as a standalone library).I use an hybrid solution:I found this one useful.\nFor VB.NET developers:I think the right answer is a combination of Steve Morgan\'s and Serguei\'s answers.  That\'s how Internet Explorer does it.  The pinvoke call to FindMimeFromData works for only 26 hard-coded mime types.  Also, it will give ambigous mime types (such as text/plain or application/octet-stream) even though there may exist a more specific, more appropriate mime type.  If it fails to give a good mime type, you can go to the registry for a more specific mime type.  The server registry could have more up-to-date mime types.Refer to:  http://msdn.microsoft.com/en-us/library/ms775147(VS.85).aspxThis class use previous answers to try in 3 different ways: harcoded based on extension, FindMimeFromData API and using registry.I came across the same issue and eventually opted for my own flavour of Kirk Baucom\'s solution, found here. It seems to me that this is an opportunity for someone to write an online look-up service.Anyway, Hope it helps.This answer is a copy of the author\'s answer (Richard Gourlay), but improved to solve issues on IIS 8 / win2012 (where function would cause app pool to crash), based on Rohland\'s comment pointing to http://www.pinvoke.net/default.aspx/urlmon.findmimefromdata...@Steve Morgan and @Richard Gourlay this is a great solution, thank you for that.  One small drawback is that when the number of bytes in a file is 255 or below, the mime type will sometimes yield "application/octet-stream", which is slightly inaccurate for files which would be expected to yield "text/plain".  I have updated your original method to account for this situation as follows:If the number of bytes in the file is less than or equal to 255 and the deduced mime type is "application/octet-stream", then create a new byte array that consists of the original file bytes repeated n-times until the total number of bytes is >= 256.  Then re-check the mime-type on that new byte array.Modified method:If someone was up for it they could port the excellent perl module File::Type to .NET. In the code is a set of file header magic number look ups for each file type or regex matches.Here\'s a .NET file type detecting library http://filetypedetective.codeplex.com/ but it only detects a smallish number of files at the moment.IIS 7 or moreUse this code, but you need to be the admin on the serverI ended up using Winista MimeDetector from Netomatix. The sources can be downloaded for free after you created an account: http://www.netomatix.com/Products/DocumentManagement/MimeDetector.aspxThis is part of another question answered here: Alternative to FindMimeFromData method in Urlmon.dll one which has more MIME types\nThe best solution to this problem in my opinion.When working with Windows Azure Web role or any other host that runs your app in Limited Trust do not forget that you will not be allowed to access registry or unmanaged code. Hybrid approach - combination of try-catch-for-registry and in-memory dictionary looks like a good solution that has a bit of everything. I use this code to do it : 