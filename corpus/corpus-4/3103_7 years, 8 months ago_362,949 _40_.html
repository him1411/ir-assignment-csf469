I\'m calling functions from a 32-bit unmanaged DLL on a 64-bit system. What I get is:BadImageFormatException: An attempt was made to load a program with an incorrect format. (Exception from HRESULT: 0x8007000B)At first, I had my projects set to the Any CPU platform, so I changed them both to x86, but this error is still occurring. That\'s really the only fix I know for this.The DLLs aren\'t corrupt or anything, because I can use them with other programs (that I don\'t have the source to). I thought that perhaps it wasn\'t finding a dependency, but I checked and they\'re all there. Plus, wouldn\'t it throw a DllNotFoundException in that case?What else can I do? And before you say "Use a 64-bit unmanaged DLL instead," let me point out that there isn\'t one. ;)If you try to run 32-bit applications on IIS 7 (and/or 64-bit OS machine), you will get the same error. So, from the IIS 7, right click on the applications\' application pool and go to "advanced settings" and change "Enable 32-Bit Applications" to "TRUE".Restart your website and it should work. Somehow, the Build checkbox in the Configuration Manager had been unchecked for my executable, so it was still running with the old Any CPU build. After I fixed that, Visual Studio complained that it couldn\'t debug the assembly, but that was fixed with a restart.In Visual Studio, Right Click your project -> On the left pane click the Build tab,under Platform Target select x86 (or more generally the architecture to match with the library you are linking to)I hope this helps someone! :)I just had this problem also. Tried all the suggestions here, but they didn\'t help. I found another thing to check that fixed it for me. In Visual Studio, right-click on the project and open "Properties". Click on the "Compile" tab and then click on "Advanced Compile Options" at the bottom. Check the dropdown "Target CPU". It should match the "Platform" you are building. That is,  if you are building "Any CPU" then "Target CPU" should say "Any CPU". Go through all of your Platforms by making them active and check this setting.If you are using Any CPU, you might encounter this issue if the Prefer 32-bit option is checked:Make sure you uncheck this option in the project\'s property\'s Build tab!If you encounter this error when you click green arrow button to run the application, but still want to run the app in 64 bit. You can do this in VS 2013 or 2015Go to: Tools > Options > Projects and Solutions > Web Projects > Use the 64 bit version of IIS ExpressA bit off topic for this post, but searching for this error message brought me here. If you are building through team system and getting this error, the build definition process tab has a "MSBuild Platform" setting. If this is set to "Auto", you may experience this problem. Changing it to "X86" can also resolve the error. In my case I was using a native DLL in C#. This DLL depended on couple of other DLLs that were missing. Once those other DLLs were added everything worked.Also see this answer, which solved the same problem for me.Posted by Luis Mack on 5/12/2010 at 8:50 AM I\'ve found the same problem, only for a specific project when compiling on a 64-bit machine. A fix that SEEMS to work is to manually alter one character in the image stream EVERY TIME the usercontrol or form is edited in the designerChange toThat is 00LjAuMC4w back to 0yLjAuMC4w at the end of the line (00 back to 0y)In my case, I am using a tiny .exe that reloads the referenced DLLs via Reflection. So I just do these steps which saves my day:From project properties on solution explorer, at build tab, I choose target platfrom x86I got this issue solved in the \'Windows\' way. After checking all my settings, cleaning the solution and rebuilding it, I simply close the solution and reopened it. Then it worked, so VS probably didn\'t get rid of some stuff during cleaning. \nWhen logical solutions don\'t work, I usually turn to illogical (or seemingly illogical) ones. Windows doesn\'t let me down. :)In my case, I was running tests through MSTest and found out that I was deploying both a 32-bit and 64-bit DLL to the test directory. The program was favoring the 64-bit DLL and causing it to fail.TL;DR Make sure you only deploy 32-bit DLLs to tests.I was able to fix this issue by matching my build version to the .NET version on the server.I double clicked the .exe just to see what would happen and it told me to install 4.5....So I downgraded to 4.0 and it worked!So make sure your versions match.  It ran on my dev box fine, but server had older .NET version.In my case it was wrong content of the file. DLL was downloaded from the web, but content of the DLL was HTML page :D\nTry to check if it is binary file, if it seems like correct DLL :)