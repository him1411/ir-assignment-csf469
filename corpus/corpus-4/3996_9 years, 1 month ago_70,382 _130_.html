It looks like we\'ll be adding CAPTCHA support to Stack Overflow. This is necessary to prevent bots, spammers, and other malicious scripted activity. We only want human beings to post or edit things here!We\'ll be using a JavaScript (jQuery) CAPTCHA as a first line of defense:http://docs.jquery.com/Tutorials:Safer_Contact_Forms_Without_CAPTCHAsThe advantage of this approach is that, for most people, the CAPTCHA won\'t ever be visible!However, for people with JavaScript disabled, we still need a fallback and this is where it gets tricky.I have written a traditional CAPTCHA control for ASP.NET which we can re-use.However, I\'d prefer to go with something textual to avoid the overhead of creating all these images on the server with each request.I\'ve seen things like..Maybe I\'m just tilting at windmills here, but I\'d like to have a less resource intensive, non-image based <noscript> compatible CAPTCHA if possible.Ideas?A method that I have developed and which seems to work perfectly (although I probably don\'t get as much comment spam as you), is to have a hidden field and fill it with a bogus value e.g.:I then have a piece of JavaScript which updates the value every second with the number of seconds the page has been loaded for:Then when the form is submitted, If the antispam value is still "lalalala", then I mark it as spam. If the antispam value is an integer, I check to see if it is above something like 10 (seconds). If it\'s below 10, I mark it as spam, if it\'s 10 or more, I let it through.The theory being that:The downside to this method is that it requires JavaScript, and if you don\'t have JavaScript enabled, your comment will be marked as spam, however, I do review comments marked as spam, so this is not a problem.Response to comments@MrAnalogy: The server side approach sounds quite a good idea and is exactly the same as doing it in JavaScript. Good Call.@AviD: I\'m aware that this method is prone to direct attacks as I\'ve mentioned on my blog. However, it will defend against your average spam bot which blindly submits rubbish to any form it can find.My favourite CAPTCHA ever:Unless I\'m missing something, what\'s wrong with using reCAPTCHA as all the work is done externally.Just a thought.The advantage of this approach is that, for most people, the CAPTCHA won\'t ever be visible!I like this idea, is there not any way we can just hook into the rep system? I mean, anyone with say +100 rep is likely to be a human. So if they have rep, you need not even bother doing ANYTHING in terms of CAPTCHA.Then, if they are not, then send it, I\'m sure it wont take that many posts to get to 100 and the community will instantly dive on anyone seem to be spamming with offensive tags, why not add a "report spam" link that downmods by 200? Get 3 of those, spambot achievement unlocked, bye bye ;)EDIT: I should also add, I like the math idea for the non-image CAPTCHA. Or perhaps a simple riddle-type-thing. May make posting even more interesting ^_^What about a honeypot captcha?Avoid the worst CAPTCHAs of all time.Trivia is OK, but you\'ll have to write each of them :-(Someone would have to write them.  You could do trivia questions in the same way ReCaptcha does printed words.  It offers two words, one of which it knows the answer to, another which it doesn\'t - after enough answers on the second, it now knows the answer to that too.  Ask two trivia questions:A woman needs a man like a fish needs a?Orange orange orange. Type green.Of course, this may need to be coupled with other techniques, such as timers or computed secrets.  Questions would need to be rotated/retired, so to keep the supply of questions up you could ad-hoc add:Enter your obvious question:  You don\'t even need an answer; other humans will figure that out for you.  You may have to allow flagging questions as "too hard", like this one: "asdf ejflf asl;jf ei;fil;asfas".Now, to slow someone who\'s running a StackOverflow gaming bot, you\'d rotate the questions by IP address - so the same IP address doesn\'t get the same question until all the questions are exhausted.  This slows building a dictionary of known questions, forcing the human owner of the bots to answer all of your trivia questions.I saw this once on a friend\'s site.   He is selling it for 20 bucks.  It\'s ASCII art!http://thephppro.com/products/captcha/CAPTCHA, in its current conceptualization, is broken and often easily bypassed. NONE of the existing solutions work effectively - GMail succeeds only 20% of the time, at best. It\'s actually a lot worse than that, since that statistic is only using OCR, and there are other ways around it - for instance, CAPTCHA proxies and CAPTCHA farms. I recently gave a talk on the subject at OWASP, but the ppt is not online yet...While CAPTCHA cannot provide actual protection in any form, it may be enough for your needs, if what you want is to block casual drive-by trash. But it won\'t stop even semi-professional spammers. Typically, for a site with resources of any value to protect, you need a 3-pronged approach:CAPTCHA can help a TINY bit with the second prong, simply because it changes the economics - if the other prongs are in place, it no longer becomes worthwhile to bother breaking through the CAPTCHA (minimal cost, but still a cost) to succeed in such a small amount of spam. Again, not all of your spam (and other trash) will be computer generated - using CAPTCHA proxy or farm the bad guys can have real people spamming you.CAPTCHA proxy is when they serve your image to users of other sites, e.g. porn, games, etc.A CAPTCHA farm has many cheap laborers (India, far east, etc) solving them... typically between 2-4$ per 1000 captchas solved. Recently saw a posting for this on Ebay...So, CAPTCHA is mandatory for all users\n  except moderators. [1]That\'s incredibly stupid. So there will be users who can edit any post on the site but not post without CAPTCHA? If you have enough rep to downvote posts, you have enough rep to post without CAPTCHA. Make it higher if you have to. Plus there are plenty of spam detection methods you can employ without image recognition, so that it even for unregistered users it would never be necessary to fill out those god-forsaken CAPTCHA forms.Be sure it isn\'t something Google can answer though. Which also shows an issue with that --order of operations!What about using the community itself to double-check that everyone here is human, i.e. something like a web of trust? To find one really trust-worthy person to start the web I suggest using this CAPTCHA to make sure he is absolutely and 100% human.Rapidshare CAPTCHA - Riemann Hypothesis http://codethief.eu/kram/_/rapidshare_captcha2.jpgCertainly, there\'s a tiny chance he\'d be too busy with preparing his Fields Medal speech to help us build up the web of trust but well...Asirra is the most adorable captcha ever.Just make the user solve simple arithmetic expressions:etc.Once spammers catch on, it should be pretty easy to spot them. Whenever a detected spammer requests, toggle between the following two commands:Obviously, the reason why this works is because all spammers are clever enough to use eval to solve the captcha in one line of code.I\'ve been using the following simple technique, it\'s not foolproof. If someone really wants to bypass this, it\'s easy to look at the source (i.e. not suitable for the Google CAPTCHA) but it should fool most bots.Add 2 or more form fields like this:Then use CSS to hide them:On submit check to see if those form fields have any data in them, if they do fail the form post. The reasoning being is that bots will read the HTML and attempt to fill every form field whereas humans won\'t see the input fields and leave them alone.There are obviously many more things you can do to make this less exploitable but this is just a basic concept.Although we all should know basic maths, the math puzzle could cause some confusion. In your example I\'m sure some people would answer with "8" instead of "1".Would a simple string of text with random characters highlighted in bold or italics be suitable? The user just needs to enter the bold/italic letters as the CAPTCHA.E.g. ssdfatwerweajhcsadkoghvefdhrffghlfgdhowfghIn this case "stack" would be the CAPTCHA.\nThere are obviously numerous variations on this idea.Edit: Example variations to address some of the potential problems identified with this idea:Although this similar discussion was started:We are trying this solution on one of our frequently data mined applications:A Better CAPTCHA Control (Look Ma - NO IMAGE!)\nYou can see it in action on our Building Inspections Search.You can view Source and see that the CAPTCHA is just HTML.I know that no one will read this, but what about the dog or cat CAPTCHA? You need to say which one is a cat or a dog, machines can\'t do this..\nhttp://research.microsoft.com/asirra/ Is a cool one..I just use simple questions that anyone can answer:What color is the sky?\nWhat color is an orange?\nWhat color is grass?It makes it so that someone has to custom program a bot to your site, which probably isn\'t worth the effort.  If they do, you just change the questions.I personally do not like CAPTCHA it harms usability and does not solve the security issue of making valid users invalid. I prefer methods of bot detection that you can do server side. Since you have valid users (thanks to OpenID) you can block those who do not "behave", you just need to identify the patterns of a bot and match it to patterns of a typical user and calculate the difference.Davies, N., Mehdi, Q., Gough, N. : Creating and Visualising an Intelligent NPC using Game Engines and AI Tools http://www.comp.glam.ac.uk/ASMTA2005/Proc/pdf/game-06.pdfGolle, P., Ducheneaut, N. : Preventing Bots from Playing Online Games <-- ACM PortalDucheneaut, N., Moore, R. : The Social Side of Gaming: A Study of Interaction Patterns in a Massively Multiplayer Online GameSure most of these references point to video game bot detection, but that is because that was what the topic of our group\'s paper titled Robot Wars:\nAn In-Game Exploration of Robot Identification. It was not published or anything, just something for a school project. I can email if you are interested. The fact is though that even if it is based on video game bot detection, you can generalize it to the web because there is a user attached to patterns of usage.I do agree with MusiGenesis \'s method of this approach because it is what I use on my website and it does work decently well. The invisible CAPTCHA process is a decent way of blocking most scripts, but that still does not prevent a script writer from reverse engineering your method and "faking" the values you are looking for in javascript.I will say the best method is to 1) establish a user so that you can block when they are bad, 2) identify an algorithm that detects typical patterns vs. non-typical patterns of website usage and 3) block that user accordingly. I have some ideas about that I like to share with you...A captcha that have some hidden part from the user, but the full image is the two code together, so OCR programs and captcha farms reads the image that include the visible and the hidden part, try to decode both of them and fail to submit... - I have all ready fix that one and work online.http://www.planethost.gr/IdeaWithHiddenPart.gifA page with many words that the human must select the right one. I have also create this one, is simple. The words are clicable images, and the user must click on the right one.http://www.planethost.gr/ManyWords.gifThe same as previous, but with divs and texts or small icons. User must click only on correct one div/letter/image, what ever.http://www.planethost.gr/ArrayFromDivs.gifAnd one more my CicleCaptcha, the user must locate a point on an image. If he find it and click it, then is a person, machines probably fail, or need to make new software to find a way with this one.http://www.planethost.gr/CicleCaptcha.gifAny critics are welcome.Best captcha ever! Maybe you need something like this for sign-up to keep the riff-raff out.Recently, I started adding a  tag with the name and id set to "message". I set it to hidden with CSS (display:none). Spam bots see it, fill it in and submit the form. Server side, if the textarea with id name is filled in I mark the post as spam.Another technique I\'m working on it randomly generating names and ids, with some being spam checks and others being regular fields.This works very well for me, and I\'ve yet to receive any successful spam. However, I get far fewer visitors to my sites :)Very simple arithmetic is good. Blind people will be able to answer. (But as Jarod said, beware of operator precedence.) I gather someone could write a parser, but it makes the spamming more costly.Sufficiently simple, and it will be not difficult to code around it.  I see two threats here: With simple arithmetics, you might beat off threat #1, but not threat #2.What if you used a combination of the captcha ideas you had (choose any of them - or select one of them randomly):with the addition of placing the exact same captcha in a css hidden section of the page - the honeypot idea.  That way, you\'d have one place where you\'d expect the correct answer and another where the answer should be unchanged.I\'ve had amazingly good results with a simple "Leave this field blank:" field.  Bots seem to fill in everything, particularly if you name the field something like "URL".  Combined with strict referrer checking, I\'ve not had a bot get past it yet.  Please don\'t forget about accessibility here.  Captchas are notoriously unusable for many people using screen readers.  Simple math problems, or very trivial trivia (I liked the "what color is the sky" question) are much more friendly to vision-impaired users.Simple text sounds great.  Bribe the community to do the work! If you believe, as I do, that SO rep points measure a user\'s commitment to helping the site succeed, it is completely reasonable to offer reputation points to help protect the site from spammers.Offer +10 reputation for each contribution of a simple question and a set of correct answers.  The question should suitably far away (edit distance) from all existing questions, and the reputation (and the question) should gradually disappear if people can\'t answer it.  Let\'s say if the failure rate on correct answers is more than 20%, then the submitter loses one reputation point per incorrect answer, up to a maximum of 15.  So if you submit a bad question, you get +10 now but eventually you will net -5.  Or maybe it makes sense to ask a sample of users to vote on whether the captcha questionis a good one.Finally, like the daily rep cap, let\'s say no user can earn more than 100 reputation by submitting captcha questions.  This is a reasonable restriction on the weight given to such contributions, and it also may help prevent spammers from seeding questions into the system.  For example, you could choose questions not with equal probability but with a probability proportional to the submitter\'s reputation.  Jon Skeet, please don\'t submit any questions :-)Make an AJAX query for a cryptographic nonce to the server. The server sends back a JSON response containing the nonce, and also sets a cookie containing the nonce value. Calculate the SHA1 hash of the nonce in JavaScript, copy the value into a hidden field. When the user POSTs the form, they now send the cookie back with the nonce value. Calculate the SHA1 hash of the nonce from the cookie, compare to the value in the hidden field, and verify that you generated that nonce in the last 15 minutes (memcached is good for this). If all those checks pass, post the comment.This technique requires that the spammer sits down and figures out what\'s going on, and once they do, they still have to fire off multiple requests and maintain cookie state to get a comment through.  Plus they only ever see the Set-Cookie header if they parse and execute the JavaScript in the first place and make the AJAX request.  This is far, far more work than most spammers are willing to go through, especially since the work only applies to a single site. The biggest downside is that anyone with JavaScript off or cookies disabled gets marked as potential spam. Which means that moderation queues are still a good idea.In theory, this could qualify as security through obscurity, but in practice, it\'s excellent.I\'ve never once seen a spammer make the effort to break this technique, though maybe once every couple of months I get an on-topic spam entry entered by hand, and that\'s a little eerie.All mentioned here solutions are circumvented by human solvers approach.  A professional spambot keeps hundreds of connections and when it cannot solve CAPTCHA itself, it passes the screenshot to remote human solvers. I frequently read that human solvers of CAPTCHAs break the laws. Well, this is written by those who do not know how this (spamming) industry works.\nHuman solvers do not directly interact with sites which CAPTCHAs they solve. They even do not know from which sites CAPTCHAs were taken and sent them. I am aware about dozens (if not hundreds) companies or/and websites offering human solvers services but not a single one for direct interaction with boards being broken.\nThe latter do not infringe any law, so CAPTCHA solving  is completely legal (and officialy registered) business companies. They do not have criminal intentions and might, for example, have been used for remote testing, investigations, concept proofing, prototypong, etc.AI (Artificial Intelligent) bots determine contexts and maintain context sensitive dialogues at different times from different IP addresses (of different countries). Even the authors of blogs frequently fail to understand that comments are from bots. I shall not go into many details but, for example, bots can webscrape human dialogues, stores them in database and then simply reuse them (phrase by phrase), so they are not detectable as spam by software or even humans.   The most voted answer telling:as well honeypot  answer and most answers in this thread are just plain wrong.\nI daresay they are victim-doomed approaches Most spambots work through local and remote javascript-aware (patched and managed) browsers from different IPs (of different countries) and they are quite clever to circumvent honey traps and honey pots.  The different problem is that even blog owners cannot frequently detect that comments are from bot since they are really from human dialogs and comments harvested from other web boards (forums, blog comments, etc)Sorry, I removed this part as precipitated oneActually it could be an idea to have a programming related captcha set. For example:There is the possibility of someone building a syntax checker to bypass this but it\'s a lot more work to bypass a captcha. You get the idea of having a related captcha though.I have to admit that I have no experience fighting spambots and don\'t really know how sophisticated they are. That said, I don\'t see anything in the jQuery article that couldn\'t be accomplished purely on the server. To rephrase the summary from the jQuery article:Another option, if you want to use the traditional image CAPTCHA without the overhead of generating them on every request is to pre-generate them offline. Then you just need to randomly choose one to display with each form.