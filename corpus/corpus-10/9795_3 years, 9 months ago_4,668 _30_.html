I have a requirement to secure a streamed WCF net.tcp service endpoint using WIF.  It should authenticate incoming calls against our token server.  The service is streamed because it is designed to transfer large amounts of data n stuff.This appears to be impossible.  And if I can\'t get around the catch, my Christmas will be ruined and I\'ll drink myself to death in a gutter while merry shoppers step over my slowly cooling body.  Totes serious, you guys.Why is this impossible?  Here\'s the Catch-22.On the client, I need to create a channel with the GenericXmlSecurityToken I get from our token server.  No problemo.Did I say "no problemo"?  Problemo.  In fact, NullReferenceException style problemo.  "Bro, " I asked the Framework, "do you even null check?"  The Framework was silent, so I disassembled and found that was the source of the exception, and that the GetProperty call was returning null.  So, WTF?  Turns out that if I turn on Message security and set the client credential type to IssuedToken then this property now exists in the ClientFactory (protip:  There is no "SetProperty" equivalent in IChannel, the bastard).Sweet. No more NREs.  However, now my client is faulted at birth (still love him, tho).  Digging through WCF diagnostics (protip:  make your worst enemies do this after crushing them and driving them before you but right before enjoying the lamentations of their women and children), I see it\'s because of a security mismatch between the server and client.The requested upgrade is not supported by \'net.tcp://localhost:49627/MyService\'. This could be due to mismatched bindings (for example security enabled on the client and not on the server).Checking the host\'s diags (again: crush, drive, read logs, enjoy lamentations), I see this is trueProtocol Type application/ssl-tls was sent to a service that does not support that type of upgrade."Well, self," I says, "I\'ll just turn on Message security on the host!"  And I do.  If you want to know what it looks like, it\'s an exact copy of the client config.  Look up.Result:  Kaboom.The binding (\'NetTcpBinding\',\'http://tempuri.org/\') supports streaming which cannot be configured together with message level security.  Consider choosing a different transfer mode or choosing the transport level security.So, my host cannot be both streamed and secured via tokens.  Catch-22.tl;dr:  How can I secure a streamed net.tcp WCF endpoint using WIF???WCF has gotchas in a few areas with streaming (I\'m looking at you, MTOM1) due to a fundamental issue in how it fails to perform preauthentication the way most people would think that should work (it only affects subsequent requests for that channel, not the first request) Ok, so this is not exactly your issue but please follow along as I will get to yours at the end. Normally the HTTP challenge works like this: Now, if you ever try to enable MTOM streaming on an WCF endpoint on the server, it will not complain. But, when you configure it on the client proxy (as you should, they must match bindings) it will explode in a fiery death. The reason for this is that the above sequence of events that WCF is trying to prevent is this:Notice that you just sent 200MB to the server when you only needed to send 100MB. Well, this is the problem. The answer is to send the authentication on the first attempt but this is not possible in WCF without writing a custom behaviour. Anyway, I digress.Your ProblemFirst up, let me tell you that what you\'re trying is impossible2. Now, in order for you to stop spinning your wheels, let me tell you why:It strikes me that you are now wandering in a similar class of problem. If you enable message level security, the client must load the entire stream of data into memory before it can actually close out the message with the usual hash function and xml signature required by ws-security. If it has to read the entire stream to sign the single message (which is not really a message, but it\'s a single continuous stream) then you can see the problem here. WCF will have to stream it once "locally" to compute the message security, then stream it again to send it to the server. This is clearly a silly thing, so WCF does not permit message level security for streaming data.So, the simple answer here is that you should send the token either as a parameter to the initial web service, or as a SOAP header and use a custom behaviour to validate it. You cannot use WS-Security to do this. Frankly, this is not just a WCF issue - I cannot see how it could practically work for any other stacks.Solving the MTOM ProblemThis is just for an example how I solved my MTOM streaming issue for basic authentication, so perhaps you could take the guts of this and implement something similar for your issue. The crux of it is that in order to enable your custom message inspector, you have to disable all notion of security on the client proxy (it remains enabled on the server,) apart from transport level (SSL):Note that I have turned off transport security here because I will be providing that myself using a message inspector and custom behaviour:So, this example is for anyone who is suffering with the MTOM issue, but also as a skeleton for you to implement something similar to authenticate your token generated by the primary WIF-secured token service.Hope this helps.(1) Large Data and Streaming(2) Message Security in WCF (see "disadvantages.")