I am configuring an MVC 3 project to work on a local install of IIS and came across the following 500 error:Handler "PageHandlerFactory-Integrated" has a bad module\n  "ManagedPipelineHandler" in its module list.It turns out that this is because ASP.Net was not completely installed with IIS even though I checked that box in the "Add Feature" dialog.  To fix this, I simply ran the following command at the command promptIf I had been on a 32 bit system, it would have looked like the following:My question is, is there a way to install IIS on a windows 7 box to use .NET 4.0 (MVC 3) without taking this extra step?It turns out that this is because ASP.Net was not completely installed with IIS even though I checked that box in the "Add Feature" dialog. To fix this, I simply ran the following command at the command promptIf I had been on a 32 bit system, it would have looked like the following:Remeber to run the command prompt as administrator (CTRL+SHIFT+ENTER)The accepted answer is correct, however sometimes you would get the "Aspnet_regiis.exe is not recognized as an internal or external command, operable program or batch file." error message.To resolve it try the following:Make sure that your .NET 4.0 installation is not corrupted (run the installer and \'Repair\' it). There\'s also a chance it is not installed on your machine at all.If you\'re sure you don\'t have .NET 4.0 installed and want to run it as .NET 2.0, try this:If you see the message "Aspnet_regiis.exe is not recognized as an\n  internal or external command, operable program or batch file.", switch\n  to the\n  C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\Aspnet_regiis.exe -i\n  at the command prompt.To solve the issue try to repair the .net framework 4 and then run the command Error: Handler \xe2\x80\x9cPageHandlerFactory-Integrated\xe2\x80\x9d has a bad module \xe2\x80\x9cManagedPipelineHandler\xe2\x80\x9d in its module listI found the articles to fix this issue by simply run the following commands at the command prompt.%windir%\\Microsoft.NET\\Framework64\\v4.0.30319\\aspnet_regiis.exe -iIf the system is 32 bit, it would have looked like this:%windir%\\Microsoft.NET\\Framework\\v4.0.21006\\aspnet_regiis.exe -iBut, when I tried to execute these commands using cmd prompt, I got the following error/warning message:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319>aspnet_regiis.exe -i Microsoft (R) ASP.NET RegIIS version 4.0.30319.33440 Administration utility to install and uninstall ASP.NET on the local machine. Copyright (C) Microsoft Corporation. All rights reserved. Start installing ASP.NET (4.0.30319.33440). This option is not supported on this version of the operating system. Administr ators should instead install/uninstall ASP.NET 4.5 with IIS8 using the "Turn Win dows Features On/Off" dialog, the Server Manager management tool, or the dism.e xe command line tool. For more details please see http://go.microsoft.com/fwlin k/?LinkID=216771. Finished installing ASP.NET (4.0.30319.33440).To fix this on a Windows 8.1  I would suggest to do the following thing.Solution:Go to - Turn Windows features on or off > Internet Information Services > World Wide Web Services > Application Development Features >Enable ASP.NET 4.5This should resolve the issue.If you want to deploy an MVC application without installing MVC, you can deploy the MVC DLL\'s with your application. This gets around installing MVC 3.  You can use features in some .Net 4.0 namespaces without installing .Net using a similar approach.I added the ISAPI/CGI paths for .Net 4. Which didn\'t fix the issue.\nSo I then ran a repair on the .Net V4 (Client and Extended) installation. Which asked for a reboot. This fixed it for me.I would also check the obvious first: that the application pool is set to the correct framework and that your IIS application actually points to the folder where you put your filesI have tried to do aspnet_regiis in command prompt but I got answer that I don\'t have admin rights.\nThen, after some more googling and looking for a solution I tried to right click cmd and run it as an admin. Confirmed yes when dialog appeared, ran aspnet_iis again ant worked like a charm.\nIn short:\n1. check .NET framework in app_pool\n2. run cmd as an admin\n3. run aspnet_regiis -i I had the same problem and my solution was:Go to "Turn Windows features on or off" > Internet Information Services > World Wide Web Services > Application Development Features >Enable ASP.NET 4.5I had a similar issue with Windows server 2012, installing the feature "Application Server" in the server manager fixed the issue.-Using application initalization feature\n-requesting wrong pages (.asp) because of config inheritance 500.21 will occur on the first user connection only. Subsequent connections work.Resolved by correcting the applicationInitialization url collection on the .NET website.To fix this on a Windows 8.1 Professional machine do the following.Install the Web Platform Installer. http://www.microsoft.com/web/downloads/platform.aspxIn Web Platform Installer install ASP.NET 4.5 (This feature has one dependency).If you simply try the aforementioned cmd prompt command from the most popular answer you will get the following error/warning message:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319>aspnet_regiis.exe -i\nMicrosoft (R) ASP.NET RegIIS version 4.0.30319.33440\nAdministration utility to install and uninstall ASP.NET on the local machine.\nCopyright (C) Microsoft Corporation.  All rights reserved.\nStart installing ASP.NET (4.0.30319.33440).\nThis option is not supported on this version of the operating system.  Administr\nators should instead install/uninstall ASP.NET 4.5 with IIS8 using the "Turn Win\ndows Features On/Off" dialog,  the Server Manager management tool, or the dism.e\nxe command line tool.  For more details please see http://go.microsoft.com/fwlin\nk/?LinkID=216771.\nFinished installing ASP.NET (4.0.30319.33440).I had this problem and found that removing the following folder helped, even with the non-Express edition.Express:C:\\Users\\<user>\\Documents\\IISExpressNone of these worked for me.  So as I compared various app pools with one that worked vs one that didn\'t, I had to go into Advanced Settings for the App Pool, and setEnable 32-Bit Applications = trueThen it worked fine!I had the same problem, in my case handler was in two places:And when I removed my handler from [system.webServer] my problem disappeared.in some scenario this error occurs because the Microsoft .NET Framework 4.0 configuration for ASP .NET has been damaged, which can occur if Microsoft Visual Studio 2012 was installed before Visual Studio 2010 or Microsoft SQL Server 2008. After trying different things i reached the conclusion, repair you .Net installation by running following command. For more information follow the link.https://msdn.microsoft.com/en-us/library/hh168535(v=nav.80).aspxI was having this issue on one of my webservers when trying to switch an apppool from classic to integrated.  It worked fine on two of my other webservers, not just this one.  It\'s Server 2012, so you can\'t do the aspnet_regiis and there was no setupcache folder to try that repair.  Everything was set correctly under features.After going through %windir%\\system32\\inetsrv\\config\\applicationHost.config I found one critical missing bit.  Under  my non-working one was missing the following two lines:Once I added them, everything worked great.To solve the issue try to repair the .net framework 4 and then run the commandenter image description here