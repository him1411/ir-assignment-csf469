I am looking for a way to delete all files older than 7 days in an MS-DOS batch file.  I\'ve searched around the web, and found some examples with hundreds of lines of code, and others that required installing extra command line utilities to accomplish the task.Similar things can be done in BASH in just a couple lines of code. It seems that something at least remotely easy could be done for batch files in Windows. I\'m looking for a solution that works in a standard Windows command prompt, without any extra utilities. Please no PowerShell or Cygwin either.Enjoy:See forfile documentation for more details.For more goodies, refer to An A-Z Index of the Windows XP command line.If you don\'t have forfiles installed on your machine, copy it from any Windows Server 2003 to your Windows XP machine at %WinDir%\\system32\\. This is possible since the EXE is fully compatible between Windows Server 2003 and Windows XP.Later versions of Windows and Windows Server have it installed by default.For Windows 7:The syntax has changed a little. Therefore the updated command is:Run the following commands:Move all the files (using /mov, which moves files and then deletes them as opposed to /move which moves whole filetrees which are then deleted) via robocopy to another location, and then execute a delete command on that path and you\'re all good.  Also if you have a directory with lots of data in it you can use /mir switch Ok was bored a bit and came up with this, which contains my version of a poor man\'s Linux epoch replacement limited for daily usage (no time retention):7daysclean.cmdset /a strip=day*7 : Change 7 for the number of days to keep.set dSource=C:\\temp : This is the starting directory to check for files.This is non-destructive code, it will display what would have happened.Change :to something like :so files actually get deletedFebruary: is hard-coded to 28 days. Bissextile years is a hell to add, really. if someone has an idea that would not add 10 lines of code, go ahead and post so I add it to my code.epoch: I did not take time into consideration, as the need is to delete files older than a certain date, taking hours/minutes would have deleted files from a day that was meant for keeping.epoch takes for granted your short date format is YYYY-MM-DD.  It would need to be adapted for other settings or a run-time evaluation (read sShortTime, user-bound configuration, configure proper field order in a filter and use the filter to extract the correct data from the argument).Did I mention I hate this editor\'s auto-formating? it removes the blank lines and the copy-paste is a hell.I hope this helps.Have a look at my answer to a similar question:This deletes files older than a given date. I\'m sure it can be modified to go back seven days from the current date.update: I notice that HerbCSO has improved on the above script. I recommend using his version instead.You should do /d -3 (3 days earlier) This works fine for me. So all the complicated batches could be in the trash bin. Also forfiles don\'t support UNC paths, so make a network connection to a specific drive.My command is@PATH - is just path in my case, so I had to use @PATH\\@FILEalso forfiles /? not working for me too, but forfiles (without "?") worked fine.And the only question I have: how to add multiple mask (for example ".log|.bak")?All this regarding forfiles.exe that I downloaded here (on win XP)But if you are using Windows server forfiles.exe should be already there and it is differs from ftp version. That is why I should modify command. For Windows Server 2003 I\'m using this command:Copy this code and save it as DelOldFiles.vbs.USAGE ONLY IN COMMAND PROMPT: cscript DelOldFiles.vbs 1515 means to delete files older than 15 days in past.Use forfiles. There are different versions. Early ones use unix style parameters. My version (for server 2000 - note no space after switches)- To add forfiles to XP, get the exe from ftp://ftp.microsoft.com/ResKit/y2kfix/x86/and add it to C:\\WINDOWS\\system32For Windows Server 2008 R2:This will delete all .sql files older than 90 days.IMO, JavaScript is gradually becoming a universal scripting standard: it is probably available in more products than any other scripting language (in Windows, it is available using the Windows Scripting Host). I have to clean out old files in lots of folders, so here is a JavaScript function to do that:For each folder to clear, just add another call to the clearFolder() function. This particular code also preserves exe and dll files, and cleans up subfolders as well.How about this modification on 7daysclean.cmd to take a leap year into account?It can be done in less than 10 lines of coding!Edit by Mofi:The condition above contributed by J.R. evaluates always to false because of invalid syntax.And Month GEQ 2 is also wrong because adding 86400 seconds for one more day must be done in a leap year only for the months March to December, but not for February.A working code to take leap day into account - in current year only - in batch file 7daysclean.cmd posted by Jay would be:There are very often relative date/time related questions to solve with batch file. But command line interpreter cmd.exe has no function for date/time calculations. Lots of good working solutions using additional console applications or scripts have been posted already here, on other pages of Stack Overflow and on other websites.Common for operations based on date/time is the requirement to convert a date/time string to seconds since a determined day. Very common is 1970-01-01 00:00:00 UTC. But any later day could be also used depending on the date range required to support for a specific task.Jay posted 7daysclean.cmd containing a fast "date to seconds" solution for command line interpreter cmd.exe. But it does not take leap years correct into account. J.R. posted an add-on for taking leap day in current year into account, but ignoring the other leap years since base year, i.e. since 1970.I use since 20 years static tables (arrays) created once with a small C function for quickly getting the number of days including leap days from 1970-01-01 in date/time conversion functions in my applications written in C/C++.This very fast table method can be used also in batch code using FOR command. So I decided to code the batch subroutine GetSeconds which calculates the number of seconds since 1970-01-01 00:00:00 UTC for a date/time string passed to this routine.Note: Leap seconds are not taken into account as the Windows file systems also do not support leap seconds.First, the tables:Days since 1970-01-01 00:00:00 UTC for each year including leap days.Calculating the seconds for year 2039 to 2106 with epoch beginning 1970-01-01 is only possible with using an unsigned 32-bit variable, i.e. unsigned long (or unsigned int) in C/C++.But cmd.exe use for mathematical expressions a signed 32-bit variable. Therefore the maximum value is 2147483647 (0x7FFFFFFF) which is 2038-01-19 03:14:07.Leap year information (No/Yes) for the years 1970 to 2106.Number of days to first day of each month in current year.Converting a date to number of seconds since 1970-01-01 is quite easy using those tables.Attention please!The format of date and time strings depends on Windows region and language settings. The delimiters and the order of tokens assigned to the environment variables Day, Month and Year in first FOR loop of GetSeconds must be adapted to local date/time format if necessary.It is necessary to adapt the date string of the environment variable if date format in environment variable DATE is different to date format used by command FOR on %%~tF.For example when %DATE% expands to Sun 02/08/2015 while %%~tF expands to 02/08/2015 07:38 PM the code below can be used with modifying line 4 to:This results in passing to subroutine just 02/08/2015 - the date string without the 3 letters of weekday abbreviation and the separating space character.Alternatively following could be used to pass current date in correct format:Now the last 10 characters from date string are passed to function GetSeconds and therefore it does not matter if date string of environment variable DATE is with or without weekday as long as day and month are always with 2 digits in expected order, i.e. in format dd/mm/yyyy  or dd.mm.yyyy.Here is the batch code with explaining comments which just outputs which file to delete and which file to keep in C:\\Temp folder tree, see code of first FOR loop.For optimal performance it would be best to remove all comments, i.e. all lines starting with rem after 0-4 leading spaces.And the arrays can be made also smaller, i.e. decreasing the time range from 1980-01-01 00:00:00 to 2038-01-19 03:14:07 as currently supported by the batch code above for example to 2015-01-01 to 2019-12-31 as the code below uses which really deletes files older than 7 days in C:\\Temp folder tree.Further the batch code below is optimized for 24 hours time format.For even more information about date and time formats and file time comparisons on Windows see my answer on Find out if file is older than 4 hours in batch file with lots of additional information about file times.Might I add a humble contribution to this already valuable thread.  I\'m finding that other solutions might get rid of the actual error text but are ignoring the %ERRORLEVEL% which signals a fail in my application. AND I legitimately want %ERRORLEVEL% just as long as it isn\'t the "No files found" error.Some Examples:Debugging and eliminating the error specifically: Using a oneliner to return ERRORLEVEL success or failure:Using a oneliner to keep the ERRORLEVEL at zero for success within the context of a batchfile in the midst of other code (ver > nul resets the ERRORLEVEL):For a SQL Server Agent CmdExec job step I landed on the following. I don\'t know if it\'s a bug, but the CmdExec within the step only recognizes the first line of code:For windows 2012 R2 the following  would work:to see the files which will be deleted use thisI think e.James\'s answer is good since it works with unmodified versions of Windows as early as Windows 2000 SP4 (and possibly earlier), but it required writing to an external file. Here is a modified version that does not create an external text file while maintaining the compatibility:To be true to the original question, here it is in a script that does ALL the math for you if you call it with the number of days as the parameter:NOTE: The code above takes into account leap years, as well as the exact number of days in each month. The only maximum is the total number of days there have been since 0/0/0 (after that it returns negative years).NOTE: The math only goes one way; it cannot correctly get future dates from negative input (it will try, but will likely go past the last day of the month).You might be able to pull this off. You can take a look at this question, for a simpler example. The complexity comes, when you start comparing the dates. It may be easy to tell if the date is greater or not, but there are many situations to consider if you need to actually get the difference between two dates.In other words - don\'t try to invent this, unless you really can\'t use the third party tools.If you have the XP resource kit, you can use robocopy to move all the old directories into a single directory, then use rmdir to delete just that one:this is nothing amazing, but i needed to do something like this today and run it as scheduled task etc.batch file, DelFilesOlderThanNDays.bat below with sample exec w/ params:DelFilesOlderThanNDays.bat 7 C:\\dir1\\dir2\\dir3\\logs *.logExpanding on aku\'s answer, I see a lot of people asking about UNC paths. Simply mapping the unc path to a drive letter will make forfiles happy. Mapping and unmapping of drives can be done programmatically in a batch file, for example.This will delete all files with a .gz extension that are older than 7 days. If you want to make sure Z: isn\'t mapped to anything else before using it you could do something simple asYou\'re probably not going to find a totally non install solution short of a complicated bat file or windows script. I use delen, drop it in a system directory then use it like the regular del command in any bat file.  ROBOCOPY works great for me.  Originally suggested my Iman.  But instead of moving the files/folders to a temporary directory then deleting the contents of the temporary folder, move the files to the trash!!! This is is a few lines of my backup batch file for example:It cleans anything older than 15 days out of my \'Temp\' folder and 30 days for anything in my AutoCAD backup folder.  I use variables because the line can get quite long and I can reuse them for other locations.  You just need to find the dos path to your recycle bin associated with your login.This is on a work computer for me and it works.  I understand that some of you may have more restrictive rights but give it a try anyway;)  Search Google for explanations on the ROBOCOPY parameters.Cheers!This one did it for me. It works with a date and you can substract the wanted amount in years to go back in time:the /F in the cmd /c del @path /F forces the specific file to be deleted in some the cases the file can be read-only.the dateYear is the year Variable and there you can change the substract to your own needsMy script to delete files older than a specific year :