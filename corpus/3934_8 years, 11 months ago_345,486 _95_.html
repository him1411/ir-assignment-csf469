If I modify or add an environment variable I have to restart the command prompt (minor inconvenience).  Is there a command I could execute that would do this without restarting CMD?You can capture the system environment variables with a vbs script, but you need a bat script to actually change the current environment variables, so this is a combined solution.Create a file named resetvars.vbs containing this code, and save it on the path:create another file name resetvars.bat containing this code, same location:When you want to refresh the environment variables, just run resetvars.bat.Apologetics:The two main problems I had coming up with this solution werea. I couldn\'t find a straightforward way to export environment variables from a vbs script back to the command prompt, and b. the PATH environment variable is a concatenation of the user and the system PATH variables.I\'m not sure what the general rule is for conflicting variables between user and system, so I elected to make user override system, except in the PATH variable which is handled specifically.I use the weird vbs+bat+temporary bat mechanism to work around the problem of exporting variables from vbs.Note: this script does not delete variables.This can probably be improved.ADDEDIf you need to export the environment from one cmd window to another, use this script (let\'s call it exportvars.vbs):Run exportvars.vbs in the window you want to export from, then switch to the window you want to export to, and type:Here is what Chocolatey uses.https://github.com/chocolatey/chocolatey/blob/master/src/redirects/RefreshEnv.cmdBy design there isn\'t a built in mechanism for Windows to propagate an environment variable add/change/remove to an already running cmd.exe, either from another cmd.exe or from "My Computer -> Properties ->Advanced Settings -> Environment Variables".If you modify or add a new environment variable outside of the scope of an existing open command prompt you either need to restart the command prompt, or, manually add using SET in the existing command prompt. The latest accepted answer shows a partial work-around by manually refreshing all the environment variables in a script. The script handles the use case of changing environment variables globally in "My Computer...Environment Variables", but if an environment variable is changed in one cmd.exe the script will not propagate it to another running cmd.exe.This works on windows 7: SET PATH=%PATH%;C:\\CmdShortcutstested by typing echo %PATH% and it worked, fine. also set if you open a new cmd, no need for those pesky reboots any more :)I came across this answer before eventually finding an easier solution. Simply restart explorer.exe in Task Manager.I didn\'t test, but you may also need to reopen you command prompt.Credit to Timo Huovinen here: Node not recognized although successfully installed (if this helped you, please go give this man\'s comment credit).Use "setx" and restart cmd promptThere is a command line tool named "setx" for this job.\nIt\'s for reading and writing env variables.\nThe variables persist after the command window has been closed.It "Creates or modifies environment variables in the user or system environment, without requiring programming or scripting. The setx command also retrieves the values of registry keys and writes them to text files."Note: variables created or modified by this tool will be available in future command windows but not in the current CMD.exe command window. So, you have to restart.If setx is missing: Or modify the registryMSDN says: To programmatically add or modify system environment variables, add\n  them to the\n  HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session\n  Manager\\Environment registry key, then broadcast a WM_SETTINGCHANGE\n  message with lParam set to the string "Environment". This allows applications, such as the shell, to pick up your updates.Calling this function has worked for me:The best method I came up with was to just do a Registry query. Here is my example.In my example I did an install using a Batch file that added new environment variables. I needed to do things with this as soon as the install was complete, but was unable to spawn a new process with those new variables. I tested spawning another explorer window and called back to cmd.exe and this worked but on Vista and Windows 7, Explorer only runs as a single instance and normally as the person logged in. This would fail with automation since I need my admin creds to do things regardless of running from local system or as an administrator on the box. The limitation to this is that it does not handle things like path, this only worked on simple enviroment variables. This allowed me to use a batch to get over to a directory (with spaces) and copy in files run .exes and etc. This was written today from may resources on stackoverflow.comOrginal Batch calls to new Batch:testenvget.cmd SDROOT (or whatever the variable)Also there is another method that I came up with from various different ideas. Please see below. This basically will get the newest path variable from the registry however, this will cause a number of issues beacuse the registry query is going to give variables in itself, that means everywhere there is a variable this will not work, so to combat this issue I basically double up the path. Very nasty. The more perfered method would be to do:\n    Set Path=%Path%;C:\\Program Files\\Software....\\Regardless here is the new batch file, please use caution.It is possible to do this by overwriting the Environment Table within a specified process itself.As a proof of concept I wrote this sample app, which just edited a single (known) environment variable in a cmd.exe process:Sample output:This approach would also be limited to security restrictions. If the target is run at higher elevation or a higher account (such as SYSTEM) then we wouldn\'t have permission to edit its memory.If you wanted to do this to a 32-bit app, the hard coded offsets above would change to 0x10 and 0x48 respectively. These offsets can be found by dumping out the _PEB and _RTL_USER_PROCESS_PARAMETERS structs in a debugger (e.g. in WinDbg dt _PEB and dt _RTL_USER_PROCESS_PARAMETERS)To change the proof-of-concept into a what the OP needs, it would just enumerate the current system and user environment variables (such as documented by @tsadok\'s answer) and write the entire environment table into the target process\' memory.Edit: The size of the environment block is also stored in the _RTL_USER_PROCESS_PARAMETERS struct, but the memory is allocated on the process\' heap. So from an external process we wouldn\'t have the ability to resize it and make it larger. I played around with using VirtualAllocEx to allocate additional memory in the target process for the environment storage, and was able to set and read an entirely new table. Unfortunately any attempt to modify the environment from normal means will crash and burn as the address no longer points to the heap (it will crash in RtlSizeHeap).Environment variables are kept in HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet\\Control\\Session Manager\\Environment.Many of the useful env vars, such as Path, are stored as REG_SZ.  There are several ways to access the registry including REGEDIT:REGEDIT /E &lt;filename&gt; "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Session Manager\\Environment"The output starts with magic numbers.  So to search it with the find command it needs to be typed and redirected: type <filename> | findstr -c:\\"Path\\"So, if you just want to refresh the path variable in your current command session with what\'s in system properties the following batch script works fine:RefreshPath.cmd:Try opening a new command prompt as an administrator. This worked for me on Windows 10. (I know this is an old answer, but I had to share this because having to write a VBS script just for this is absurd).In windows 7/8/10,Just type "refreshenv" without quotes. It works on my machine win8.1I use the following code in my batch scripts:By using SET after SETX it is possible to use the "local" variable directly without restarting the command window. And on the next run, the enviroment variable will be used.just restart explorer.exe  >> tested on win 8 X64The easiest way to add a variable to the path without rebooting for the current session is to open the command prompt and type: and press enter. to check if your variable loaded, type and press enter. However, the variable will only be a part of the path until you reboot.There is no straight way, as Kev said. In most cases, it is simpler to spawn another CMD box. More annoyingly, running programs are not aware of changes either (although IIRC there might be a broadcast message to watch to be notified of such change).It have been worse: in older versions of Windows, you had to log off then log back to take in account the changes...I liked the approach followed by chocolatey, as posted in anonymous coward\'s answer, since it is a pure batch approach. However, it leaves a temporary file and some temporary variables lying around. I made a cleaner version for myself.Make a file refreshEnv.bat somewhere on your PATH. Refresh your console environment by executing refreshEnv.I use this Powershell script to add to the PATH variable.\nWith a little adjustment it can work in your case too I believe.no, I don\'t think so...  you can set them manually though.   So you can put them in a batch file or something.probably could make a utility/script (if someone hasn\'t already) that queries the registry and sets the current enviroment to be the sameEdit: this only works if the environment changes you\'re doing are as a result of running a batch file.If a batch file begins with SETLOCAL then it will always unravel back to your original environment on exit even if you forget to call ENDLOCAL before the batch exits, or if it aborts unexpectedly.Almost every batch file I write begins with SETLOCAL since in most cases I don\'t want the side-effects of environment changes to remain. In cases where I do want certain environment variable changes to propagate outside the batch file then my last ENDLOCAL looks like this:Restarting explorer did this for me, but only for new cmd terminals. The terminal I set the path could see the new Path variable already (in Windows 7).If it concerns just one (or a few) specific vars you want to change, I think the easiest way is a workaround: just set in in your environment AND in your current console sessionI have this simple batch script to change my Maven from Java7 to Java8 (which are both env. vars) The batch-folder is in my PATH var so I can always call \'j8\' and within my console and in the environment my JAVA_HOME var gets changed:j8.bat:Till now I find this working best and easiest. \nYou probably want this to be in one command, but it simply isn\'t there in Windows...The confusing thing might be that there are a few places to start the cmd from.\nIn my case I ran cmd from windows explorer and the environment variables did not change while when starting cmd from the "run" (windows key + r) the environment variables were changed.In my case I just had to kill the windows explorer process from the task manager and then restart it again from the task manager.Once I did this I had access to the new environment variable from a cmd that was spawned from windows explorer.To solve this I have changed the environment variable using BOTH setx and set, and then restarted all instances of explorer.exe. This way any process subsequently started will have the new environment variable.My batch script to do this:The problem with this approach is that all explorer windows that are currently opened will be closed, which is probably a bad idea - But see the post by Kev to learn why this is necessaryOr you can just do it manually via To view or change environment variables: Right-click My Computer, and\n  then click Properties. Click the Advanced tab. Click Environment\n  variables. Click one the following options, for either a user or a\n  system variable: Click New to add a new variable name and value. Click\n  an existing variable, and then click Edit to change its name or value.\n  Click an existing variable, and then click Delete to remove it.\n  http://support.microsoft.com/kb/310519Windows XP  Environment variablesWindows 7 Environment variableshttp://www.binbert.com/blog/2010/09/default-environment-variable-values-of-windows-7-xp/hope this helps.Just type "#  -r" (without quotes  # with -r option)  in your terminal. \nAnd you\'re all set to default paths :)