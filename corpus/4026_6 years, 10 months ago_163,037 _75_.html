What are the best or most useful configurations for logging with NLog? (These can be simple or complex, as long as they\'re useful.) I\'m thinking of examples like automatically rolling over log files at a certain size, changing the layout (log message) whether or not there is an exception, escalating the log level once an error has occurred, etc.Here are some links:Some of these fall into the category of general NLog (or logging) tips rather than strictly configuration suggestions.Here are some general logging links from here at SO (you might have seen some or all of these already):log4net vs. NlogLogging best practicesWhat's the point of a logging facade?Why do loggers recommend using a logger per class?Use the common pattern of naming your logger based on the class Logger logger = LogManager.GetCurrentClassLogger().  This gives you a high degree of granularity in your loggers and gives you great flexibility in the configuration of the loggers (control globally, by namespace, by specific logger name, etc).Use non-classname-based loggers where appropriate.  Maybe you have one function for which you really want to control the logging separately.  Maybe you have some cross-cutting logging concerns (performance logging).If you don\'t use classname-based logging, consider naming your loggers in some kind of hierarchical structure (maybe by functional area) so that you can maintain greater flexibility in your configuration.  For example, you might have a "database" functional area, an "analysis" FA, and a "ui" FA.  Each of these might have sub-areas.  So, you might request loggers like this:And so on.  With hierarchical loggers, you can configure logging globally (the "*" or root logger), by FA (Database, Analysis, UI), or by subarea (Database.Connect, etc).Loggers have many configuration options:See the NLog help for more info on exactly what each of the options means.  Probably the most notable items here are the ability to wildcard logger rules, the concept that multiple logger rules can "execute" for a single logging statement, and that a logger rule can be marked as "final" so subsequent rules will not execute for a given logging statement.Use the GlobalDiagnosticContext, MappedDiagnosticContext, and NestedDiagnosticContext to add additional context to your output.Use "variable" in your config file to simplify.  For example, you might define variables for your layouts and then reference the variable in the target configuration rather than specify the layout directly.  Or, you could create a "custom" set of properties to add to a layout.Or, you can do stuff like create "day" or "month" layout renderers strictly via configuration:You can also use layout renders to define your filename:If you roll your file daily, each file could be named "Monday.log", "Tuesday.log", etc.Don\'t be afraid to write your own layout renderer.  It is easy and allows you to add your own context information to the log file via configuration.  For example, here is a layout renderer (based on NLog 1.x, not 2.0) that can add the Trace.CorrelationManager.ActivityId to the log:Tell NLog where your NLog extensions (what assembly) like this:Use the custom layout renderer like this:Use async targets:And default target wrappers:where appropriate.  See the NLog docs for more info on those.Tell NLog to watch and automatically reload the configuration if it changes:There are several configuration options to help with troubleshooting NLogSee NLog Help for more info.NLog 2.0 adds LayoutRenderer wrappers that allow additional processing to be performed on the output of a layout renderer (such as trimming whitespace, uppercasing, lowercasing, etc).Don\'t be afraid to wrap the logger if you want insulate your code from a hard dependency on NLog, but wrap correctly.  There are examples of how to wrap in the NLog\'s github repository.  Another reason to wrap might be that you want to automatically add specific context information to each logged message (by putting it into LogEventInfo.Context).There are pros and cons to wrapping (or abstracting) NLog (or any other logging framework for that matter).  With a little effort, you can find plenty of info here on SO presenting both sides.If you are considering wrapping, consider using Common.Logging.  It works pretty well and allows you to easily switch to another logging framework if you desire to do so.  Also if you are considering wrapping, think about how you will handle the context objects (GDC, MDC, NDC).  Common.Logging does not currently support an abstraction for them, but it is supposedly in the queue of capabilities to add.We often want to get more information when there is an exception. The following configuration has two targets, a file and the console, which filter on whether or not there is any exception info. (EDIT: Jarek has posted about a new method of doing this in vNext.)The key is to have a wrapper target with xsi:type="FilteringWrapper" condition="length(\'${exception}\')>0"Apparently, you can now use NLog with Growl for Windows.\n\n\n\n\n\nConfigure NLog via XML, but ProgrammaticallyWhat?  Did you know that you can specify the NLog XML directly to NLog from your app, as opposed to having NLog read it from the config file?  Well, you can.  Let\'s say that you have a distributed app and you want to use the same configuration everywhere.  You could keep a config file in each location and maintain it separately, you could maintain one in a central location and push it out to the satellite locations, or you could probably do a lot of other things.  Or, you could store your XML in a database, get it at app startup, and configure NLog directly with that XML (maybe checking back periodically to see if it had changed).I\'m not sure how robust this is, but this example provides a useful starting point for people that might want to try configuring like this.This example allows you to get more information when there is an error in your code. Basically, it buffers messages and only outputs those at a certain log level (e.g. Warn) unless a certain condition is met (e.g. there has been an error, so the log level is >= Error), then it will output more info (e.g. all messages from log levels >= Trace). Because the messages are buffered, this lets you gather trace information about what happened before an Error or ErrorException was logged - very useful!I adapted this one from an example in the source code. I was thrown at first because I left out the AspNetBufferingWrapper (since mine isn\'t an ASP app) - it turns out that the PostFilteringWrapper requires some buffered target. Note that the target-ref element used in the above-linked example cannot be used in NLog 1.0 (I am using 1.0 Refresh for a .NET 4.0 app); it is necessary to put your target inside the wrapper block. Also note that the logic syntax (i.e. greater-than or less-than symbols, < and >) has to use the symbols, not the XML escapes for those symbols (i.e. &gt; and &lt;) or else NLog will error.app.config:I provided a couple of reasonably interesting answers to this question:Nlog - Generating Header Section for a log fileAdding a Header:The question wanted to know how to add a header to the log file.  Using config entries like this allow you to define the header format separately from the format of the rest of the log entries.  Use a single logger, perhaps called "headerlogger" to log a single message at the start of the application and you get your header:Define the header and file layouts:Define the targets using the layouts:Define the loggers:Write the header, probably early in the program:This is largely just another version of the "Treating exceptions differently" idea.Log each log level with a different layoutSimilarly, the poster wanted to know how to change the format per logging level.  It wasn\'t clear to me what the end goal was (and whether it could be achieved in a "better" way), but I was able to provide a configuration that did what he asked:Again, very similar to Treating exceptions differently.Log to TwitterBased on this post about a log4net Twitter Appender, I thought I would try my hand at writing a NLog Twitter Target (using NLog 1.0 refresh, not 2.0).  Alas, so far I have not been able to get a Tweet to actually post successfully.  I don\'t know if it is something wrong in my code, Twitter, our company\'s internet connection/firewall, or what.  I am posting the code here in case someone is interested in trying it out.  Note that there are three different "Post" methods.  The first one that I tried is PostMessageToTwitter.  PostMessageToTwitter is essentially the same as PostLoggingEvent in the orignal post.  If I use that I get a 401 exception.  PostMessageBasic gets the same exception.  PostMessage  runs with no errors, but the message still does not make it up to Twitter.  PostMessage and PostMessageBasic are based on examples that I found here on SO.FYI - I just now found a comment by @Jason Diller to an answer in this post that says that twitter is going to turn off basic authentication "next month".  This was back in May 2010 and it is now December 2010, so I guess that could be why this is not working.Configure it like this:Tell NLog the assembly containing the target:Configure the target:If someone tries this out and has success, post back with your findings.I wanted a way to simply and automatically report errors (since users often don\'t) from our applications. The easiest solution I could come up with was a public URL - a web page which could take input and store it to a database - that is sent data upon an application error. (The database could then be checked by a dev or a script to know if there are new errors.)I wrote the web page in PHP and created a mysql database, user, and table to store the data. I decided on four user variables, an id, and a timestamp. The possible variables (either included in the URL or as POST data) are:(All of the variables are optional, but nothing is reported if none of them are set - so if you just visit the website URL nothing is sent to the db.)To send the data to the URL, I used NLog\'s WebService target. (Note, I had a few problems with this target at first. It wasn\'t until I looked at the source that I figured out that my url could not end with a /.)All in all, it\'s not a bad system for keeping tabs on external apps. (Of course, the polite thing to do is to inform your users that you will be reporting possibly sensitive data and to give them a way to opt in/out.)(The db user has only INSERT privileges on this one table in its own database.)(PHP 5.3 or 5.2 with PDO enabled, file is index.php in /report folder)Note: there may be some issues with the size of the log file, but I haven\'t figured out a simple way to truncate it (e.g. a la *nix\'s tail command).Easier Way To Log each log level with a different layout using Conditional LayoutsSee http://nlog-project.org/wiki/Conditions for syntaxLog from SilverlightWhen using NLog with Silverlight you can send the trace to the server side via the provided web service.  You can also write to a local file in the Isolated Storage, which come in handy if the web server is unavailable. See here for details, i.e. use something like this to make yourself a target: