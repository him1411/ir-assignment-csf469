I need to create a nice installer for a Mac application. I want it to be a disk image (DMG), with a predefined size, layout and background image.I need to do this programmatically in a script, to be integrated in an existing build system (more of a pack system really, since it only create installers. The builds are done separately). I already have the DMG creation done using "hdiutil", what I haven\'t found out yet is how to make an icon layout and specify a background bitmap.After lots of research, I\'ve come up with this answer, and I\'m hereby putting it here as an answer for my own question, for reference:Make sure that "Enable access for assistive devices" is checked in System Preferences>>Universal Access. It is required for the AppleScript to work. You may have to reboot after this change (it doesn\'t work otherwise on Mac OS X Server 10.4).Create a R/W DMG. It must be larger than the result will be. In this example, the bash variable "size" contains the size in Kb and the contents of the folder in the "source" bash variable will be copied into the DMG:Mount the disk image, and store the device name (you might want to use sleep for a few seconds after this operation):Store the background picture (in PNG format) in a folder called ".background" in the DMG, and store its name in the "backgroundPictureName" variable. Use AppleScript to set the visual styles (name of .app must be in bash variable "applicationName", use variables for the other properties as needed):Finialize the DMG by setting permissions properly, compressing and releasing it:On Snow Leopard, the above applescript will not set the icon position correctly - it seems to be a Snow Leopard bug. One workaround is to simply call close/open after setting the icons, i.e.:There\'s a little Bash script called create-dmg that builds fancy DMGs with custom backgrounds, custom icon positioning and volume name.I\'ve built it many years ago for the company that I ran at the time; it survives on other people\'s contribution since then, and reportedly works well.There\'s also node-appdmg which looks like a more modern and active effort based on Node.js; check it out as well.Don\'t go there. As a long term Mac developer, I can assure you, no solution is really working well. I tried so many solutions, but they are all not too good. I think the problem is that Apple does not really document the meta data format for the necessary data.Here\'s how I\'m doing it for a long time, very successfully:Create a new DMG, writeable(!), big enough to hold the expected binary and extra files like readme (sparse might work).Mount the DMG and give it a layout manually in Finder or with whatever tools suits you for doing that (see FileStorm link at the bottom for a good tool). The background image is usually an image we put into a hidden folder (".something") on the DMG. Put a copy of your app there (any version, even outdated one will do). Copy other files (aliases, readme, etc.) you want there, again, outdated versions will do just fine. Make sure icons have the right sizes and positions (IOW, layout the DMG the way you want it to be).Unmount the DMG again, all settings should be stored by now.Write a create DMG script, that works as follows: This method may not sound optimal, but trust me, it works really well in practice. You can put the original DMG (DMG template) even under version control (e.g. SVN), so if you ever accidentally change/destroy it, you can just go back to a revision where it was still okay. You can add the DMG template to your Xcode project, together with all other files that belong onto the DMG (readme, URL file, background image), all under version control and then create a target (e.g. external target named "Create DMG") and there run the DMG script of above and add your old main target as dependent target. You can access files in the Xcode tree using ${SRCROOT} in the script (is always the source root of your product) and you can access build products by using ${BUILT_PRODUCTS_DIR} (is always the directory where Xcode creates the build results).Result: Actually Xcode can produce the DMG at the end of the build. A DMG that is ready to release. Not only you can create a relase DMG pretty easy that way, you can actually do so in an automated process (on a headless server if you like), using xcodebuild from command line (automated nightly builds for example).Regarding the initial layout of the template, FileStorm is a good tool for doing it. It is commercial, but very powerful and easy to use. The normal version is less than $20, so it is really affordable. Maybe one can automate FileStorm to create a DMG (e.g. via AppleScript), never tried that, but once you have found the perfect template DMG, it\'s really easy to update it for every release.Bringing this question up to date by providing this answer.appdmg is a simple, easy-to-use, open-source command line program that creates dmg-files from a simple json specification. Take a look at the readme at the official website:https://github.com/LinusU/node-appdmgQuick example:Install appdmgWrite a json file (spec.json)Run program(disclaimer. I\'m the creator of appdmg)For those of you that are interested in this topic, I should mention how I create the DMG:whereMy app, DropDMG, is an easy way to create disk images with background pictures, icon layouts, custom volume icons, and software license agreements. It can be controlled from a build system via the "dropdmg" command-line tool or AppleScript. If desired, the picture and license RTF files can be stored under your version control system.I found this great mac app to automate the process - http://www.araelium.com/dmgcanvas/\nyou must have a look if you are creating dmg installer for your mac appIf you want to set custom volume icon then use below commandNow create read/write dmg.DS_Store files stores windows settings in Mac.  Windows settings include the icons layout, the window background, the size of the window, etc.  The .DS_Store file is needed in creating the window for mounted images to preserve the arrangement of files and the windows background.Once you have .DS_Store file created, you can just copy it to your created installer (DMG).I also in need of using command line approach to do the packaging and dmg creation "programmatically in a script". The best answer I found so far is from Adium project\' Release building framework (See R1). There is a custom script(AdiumApplescriptRunner) to allow you avoid OSX WindowsServer GUI interaction. "osascript applescript.scpt" approach require you to login as builder and run the dmg creation from a command line vt100 session.OSX package management system is not so advanced compared to other Unixen which can do this task easily and systematically.R1: http://hg.adium.im/adium-1.4/file/00d944a3ef16/ReleaseFor creating a nice looking DMG, you can now just use some well written open sources:These answers are way too complicated and times have changed.  The following works on 10.9 just fine, permissions are correct and it looks nice.If anything else needs to happen, these easiest thing is to make a temporary copy of the SRC_DIR and apply changes to that before creating a DMG.I\'ve just written a new (friendly) command line utility to do this.  It doesn\xe2\x80\x99t rely on Finder/AppleScript, or on any of the (deprecated) Alias Manager APIs, and it\xe2\x80\x99s easy to configure and use.Anyway, anyone who is interested can find it on PyPi; the documentation is available on Read The Docs.I finally got this working in my own project (which happens to be in Xcode). Adding these 3 scripts to your build phase will automatically create a Disk Image for your product that is nice and neat. All you have to do is build your project and the DMG will be waiting in your products folder.Script 1 (Create Temp Disk Image):Script 2 (Set Window Properties Script):The above measurement for the window work for my project specifically due to the size of my background pic and icon resolution; you may need to modify these values for your own project.Script 3 (Make Final Disk Image Script):Make sure the image files you are using are in the $PROJECT_DIR/$PROJECT_NAME/ directory!