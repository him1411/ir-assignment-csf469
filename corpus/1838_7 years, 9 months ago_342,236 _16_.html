I need to write a unit test for a method that takes a stream which comes from a txt file, I would like to do do something like this:Don\'t forget to use Using:About the StreamWriter not being disposed. StreamWriter is just a wrapper around the base stream, and doesn\'t use any resources that need to be disposed. The Dispose method will close the underlying Stream that StreamWriter is writing to. In this case that is the MemoryStream we want to return.In .NET 4.5 there is now an overload for StreamWriter that keeps the underlying stream open after the writer is disposed of, but this code does the same thing and works with other versions of .NET too.See Is there any way to close a StreamWriter without closing its BaseStream?Another solution:Add this to a static string utility class:This adds an extension function so you can simply:Use the MemoryStream class, calling Encoding.GetBytes to turn your string into an array of bytes first.Do you subsequently need a TextReader on the stream? If so, you could supply a StringReader directly, and bypass the MemoryStream and Encoding steps.Here you go:I think you can benefit from using a MemoryStream. You can fill it with the string bytes that you obtain by using the GetBytes method of the Encoding class.I used mix of answers like this: and then i use it like this : We use these extension methods. I think you should make the dev make a decision about the Encoding so there is less magic involved.A good combination of String extensions: