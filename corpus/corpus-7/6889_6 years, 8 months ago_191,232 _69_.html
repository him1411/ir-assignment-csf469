How to calculate the difference in months between two dates in C#?Is there is equivalent of VB\'s DateDiff() method in C#. I need to find difference in months between two dates that are years apart. The documentation says that I can use TimeSpan like:but this gives me data in Days. I don\'t want to divide this number by 30 because not every month is 30 days and since the two operand values are quite apart from each other, I am afraid dividing by 30 might give me a wrong value.Any suggestions?Assuming the day of the month is irrelevant (i.e. the diff between 2011.1.1 and 2010.12.31 is 1), with date1 > date2 giving a positive value and date2 > date1 a negative valueOr, assuming you want an approximate number of \'average months\' between the two dates, the following should work for all but very huge date differences.Note, if you were to use the latter solution then your unit tests should state the widest date range which your application is designed to work with and validate the results of the calculation accordingly.Update (with thanks to Gary)If using the \'average months\' method, a slightly more accurate number to use for the \'average number of days per year\' is 365.2425.Here is a comprehensive solution to return a DateTimeSpan, similar to a TimeSpan, except that it includes all the date components in addition to the time components.Usage:Outputs:Years: 1\n  Months: 5\n  Days: 27\n  Hours: 1\n  Minutes: 36\n  Seconds: 50\n  Milliseconds: 0  For convenience, I\'ve lumped the logic into the DateTimeSpan struct, but you may move the method CompareDates wherever you see fit.  Also note, it doesn\'t matter which date comes before the other.If you want the exact number of full months, always positive (2000-01-15, 2000-02-14 returns 0), considering a full month is when you reach the same day the next month (something like the age calculation)Edit reason: the old code was not correct in some cases like : Test cases I used to test the function:I checked the usage of this method in VB.NET via MSDN and it seems that it has a lot of usages. There is no such a built-in method in C#. (Even it\'s not a good idea) you can call VB\'s in C#.You could do To get difference in months (both start and end inclusive), irrespective of dates:I just needed something simple to cater for e.g. employment dates where only the month/year is entered, so wanted distinct years and months worked in. This is what I use, here for usefullness only.NET FiddleYou can use the DateDiff class of the Time Period Library for .NET:Use Noda Time:(example source)This is from my own library, will return the difference of months between two dates.You can have a function something like this.For Example, from 2012/12/27 to 2012/12/29 becomes 3 days. Likewise, from 2012/12/15 to 2013/01/15 becomes 2 months, because up to 2013/01/14 it\'s 1 month. from 15th it\'s 2nd month started.You can remove the "=" in the second if condition, if you do not want to include both days in the calculation. i.e, from 2012/12/15 to 2013/01/15 is 1 month.This worked for what I needed it for. The day of month didn\'t matter in my case because it always happens to be the last day of the month.Here\'s a much more concise solution using VB.Net DateDiff for Year, Month, Day only. You can load the DateDiff library in C# as well.date1 must be <= date2VB.NETC#To be able to calculate the difference between 2 dates in months is a perfectly logical thing to do, and is needed in many business applications.  The several coders here who have provided comments such as - what\'s the difference in months between "May 1,2010" and "June 16,2010, what\'s the difference in months between 31 December 2010 and 1 Jan 2011? -- have failed to understand the very basics of business applications.Here is the answer to the above 2 comments - The number of months between 1-may-2010 and 16-jun-2010 is 1 month, the number of months between 31-dec-2010 and 1-jan-2011 is 0.  It would be very foolish to calculate them as 1.5 months and 1 second, as the coders above have suggested.People who have worked on credit card, mortgage processing, tax processing, rent processing, monthly interest calculations and a vast variety of other business solutions would agree.Problem is that such a function is not included in C# or VB.NET for that matter.  Datediff only takes into account years or the month component, so is actually useless.Here are some real-life examples of where you need to and correctly can calculate months:You lived in a short-term rental from 18-feb to 23-aug.  How many months did you stay there?  The answer is a simple -  6 monthsYou have a bank acount where interest is calculated and paid at the end of every month.  You deposit money on 10-jun and take it out 29-oct (same year).  How many months do you get interest for?  Very simple answer-  4 months  (again the extra days do not matter)In business applications, most of the time, when you need to calculate months, it is because you need to know \'full\' months based on how humans calculate time; not based on some abstract/irrelevant thoughts.This solution is for Rental/subscription calculation, where difference doesn\'t means to be subtraction, it\'s meant to be the span in within those two dates.There\'s 3 cases: same year, previous year and other years.If the day of the month does not matter...Expanded Kirks struct with ToString(format) and Duration(long ms)There are not a lot of clear answers on this because you are always assuming things.This solution calculates between two dates the months between assuming you want to save the day of month for comparison, (meaning that the day of the month is considered in the calculation)Example, if you have a date of 30 Jan 2012, 29 Feb 2012 will not be a month but 01 March 2013 will.It\'s been tested pretty thoroughly, probably will clean it up later as we use it, but here:I wrote a function to accomplish this, because the others ways weren\'t working for me.Here\'s how we approach this:My understanding of the total months difference between 2 dates has an integral and a fractional part (the date matters).The integral part is the full months difference.The fractional part, for me, is the difference of the % of the day (to the full days of month) between the starting and ending months. With this extension, those are the results:you can use the following extension:\nCodeImplementation !The most precise way is this that return difference in months by fraction :Here is my solution that works (at least for me). It\'s probably not the fastest though because it uses the cool DateTime\'s AddMonth feature:Here is my contribution to get difference in Months that I\'ve found to be accurate:Usage:You can create another method called DiffYears and apply exactly the same logic as above and AddYears instead of AddMonths in the while loop.This is in response to Kirk Woll\'s answer. I don\'t have enough reputation points to reply to a comment yet... I liked Kirk\'s solution and was going to shamelessly rip it off and use it in my code, but when I looked through it I realized it\'s way too complicated. Unnecessary switching and looping, and a public constructor that is pointless to use. Here\'s my rewrite: Usage1, pretty much the same: Usage2, similar: LINQ Solution,