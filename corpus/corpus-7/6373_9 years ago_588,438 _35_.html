How can I script a bat or cmd to stop and start a service reliably with error checking (or let me know that it wasn\'t successful for whatever reason)?Use the SC (service control) command, it gives you a lot more options than just start & stop.andtell you whether they have succeeded or failed pretty clearly. For exampleIf running from a batch file, you have access to the ERRORLEVEL of the return code. 0 indicates success. Anything higher indicates failure.As a bat file, error.bat:The output looks like this:Return CodesEdit 20.04.2015Return Codes:  The NET command does not return the documented Win32_Service class return codes (Service Not Active,Service Request Timeout, etc) and for many errors will simply return Errorlevel 2.Look here: http://ss64.com/nt/net_service.htmlYou can use the NET START command and then check the ERRORLEVEL environment variable, e.g.Disclaimer: I\'ve written this from the top of my head, but I think it\'ll work.Instead of checking codes, this works tooUsing the return codes from net start and net stop seems like the best method to me. Try a look at this: Net Start return codes.Syntax always gets me.... so...Here is explicitly how to add a line to a batch file that will kill a remote service (on another machine) if you are an admin on both machines, run the .bat as an administrator, and the machines are on the same domain. The machine name follows the UNC format \\myserverIn this case... p4_1 was both the Service Name and the Display Name, when you view the Properties for the service in Service Manager. You must use the Service Name.For your Service Ops junkies... be sure to append your reason code and comment! i.e. \'4\' which equals \'Planned\' and comment \'Stopping server for maintenance\'I have created my personal batch file for this, mine is a little different but feel free to modify as you see fit.\nI created this a little while ago because I was bored and wanted to make a simple way for people to be able to input ending, starting, stopping, or setting to auto. This BAT file simply requests that you input the service name and it will do the rest for you. I didn\'t realize that he was looking for something that stated any error, I must have misread that part. Though typically this can be done by inputting >> output.txt on the end of the line. The %var% is just a way for the user to be able to input their own service into this, instead of having to go modify the bat file every time that you want to start/stop a different service. If I am wrong, anyone can feel free to correct me on this. We\'d like to think that "net stop " will stop the service.  Sadly, reality isn\'t that black and white.  If the service takes a long time to stop, the command will return before the service has stopped.  You won\'t know, though, unless you check errorlevel.The solution seems to be to loop round looking for the state of the service until it is stopped, with a pause each time round the loop.But then again...I\'m seeing the first service take a long time to stop, then the "net stop" for a subsequent service just appears to do nothing.  Look at the service in the services manager, and its state is still "Started" - no change to "Stopping".  Yet I can stop this second service manually using the SCM, and it stops in 3 or 4 seconds.or you can start remote service with this cmd : sc \\\\<computer> start <service>I just used Jonas\' example above and created full list of 0 to 24 errorlevels.  Other post is correct that net start and net stop only use errorlevel 0 for success and 2 for failure.But this is what worked for me:Change stop to start and works in reverse.SC can do everything with services... start, stop, check, configure, and more... Manual service restart is ok - services.msc has "Restart" button, but in command line both sc and net commands lacks a "restart" switch and if restart is scheduled in cmd/bat file, service is stopped and started immediately, sometimes it gets an error because service is not stopped yet, it needs some time to shut things down. This may generate an error:\nsc stop \nsc start It is a good idea to insert timeout, I use ping (it pings every 1 second):\nsc stop \nping localhost -n 60\nsc start 